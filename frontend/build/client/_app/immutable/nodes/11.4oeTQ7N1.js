import"../chunks/CWj6FrbW.js";import{o as lt,s as N}from"../chunks/BnHnlVXU.js";import{c as Me,f as ne,a as i,p as it,k as j,R as ye,S as Ge,i as e,s as u,t as $,j as ae,b as nt,e as dt,h as r,d as n,U as K,$ as ct,n as M,r as t,g as a,a3 as Ie,V as vt}from"../chunks/BbuzmxRY.js";import{i as C}from"../chunks/XgF_cVEg.js";import{I as Te,s as Ae,e as oe,i as se,b as le,r as Q,c as pe}from"../chunks/Bm_MFDQ1.js";import{h as pt}from"../chunks/BwaF3Q6U.js";import{b as W}from"../chunks/BjJ5yzjH.js";import{g as ut}from"../chunks/Cak3-npf.js";import{p as ie}from"../chunks/BVZH3wAp.js";import{A as Ne}from"../chunks/3e7qVaIY.js";import"../chunks/COK2pY8o.js";import{l as qe,s as Fe}from"../chunks/cVoOpi3M.js";import{T as bt,R as ft}from"../chunks/BB-mXNPS.js";function gt(X,F){const v=qe(F,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];Te(X,Fe({name:"arrow-right"},()=>v,{get iconNode(){return h},children:(T,ue)=>{var A=Me(),D=ne(A);Ae(D,F,"default",{}),i(T,A)},$$slots:{default:!0}}))}function Be(X,F){const v=qe(F,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=[["path",{d:"M20 6 9 17l-5-5"}]];Te(X,Fe({name:"check"},()=>v,{get iconNode(){return h},children:(T,ue)=>{var A=Me(),D=ne(A);Ae(D,F,"default",{}),i(T,A)},$$slots:{default:!0}}))}var _t=n('<span class="text-sm font-semibold"></span>'),mt=n("<div></div>"),xt=n('<div class="flex items-center flex-1"><div class="flex flex-col items-center"><div><!></div> <span> </span></div> <!></div>'),yt=n('<div class="mb-6 bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),ht=n('<div class="space-y-4"><h2 class="text-xl font-semibold text-gray-900">Basic Information</h2> <div><label for="name" class="block text-sm font-medium text-gray-700 mb-2">Project Name *</label> <input id="name" type="text" placeholder="My Security Rules Project" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/></div> <div><label for="description" class="block text-sm font-medium text-gray-700 mb-2">Description (optional)</label> <textarea id="description" placeholder="Describe this project..." rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"></textarea></div> <div><label class="block text-sm font-medium text-gray-700 mb-2">Sync Mode *</label> <div class="grid grid-cols-2 gap-3"><button type="button"><span class="text-sm font-semibold text-gray-900">Full Workflow</span> <span class="text-xs text-gray-500 mt-1 text-left">Export to Git, create merge requests, and import to production</span></button> <button type="button"><span class="text-sm font-semibold text-gray-900">Export Only</span> <span class="text-xs text-gray-500 mt-1 text-left">Only export rules from Elastic to Git (one-way sync)</span></button></div></div></div>'),wt=n('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800">No Elastic instances configured. Please add one in settings first.</p> <a href="/settings/elastic" class="text-sm text-blue-600 hover:underline mt-2 inline-block">Add Elastic Instance</a></div>'),Pt=n("<option> </option>"),kt=n('<div><label for="elastic-instance" class="block text-sm font-medium text-gray-700 mb-2">Elastic Instance *</label> <select id="elastic-instance" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select instance...</option><!></select></div>'),jt=n('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800">No Git repositories configured. Please add one in settings first.</p> <a href="/settings/git" class="text-sm text-blue-600 hover:underline mt-2 inline-block">Add Git Repository</a></div>'),St=n("<option> </option>"),Et=n('<div><label for="git-repo" class="block text-sm font-medium text-gray-700 mb-2">Git Repository *</label> <select id="git-repo" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select repository...</option><!></select></div> <div><label for="git-path" class="block text-sm font-medium text-gray-700 mb-2">Base Path in Repository (optional)</label> <input id="git-path" type="text" placeholder="detection-rules/" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Base directory for rules. Environments will have subdirectories.</p></div>',1),Rt=n('<div class="space-y-4"><h2 class="text-xl font-semibold text-gray-900">Connections</h2> <p class="text-sm text-gray-500">Select the Elastic instance and Git repository for this project.</p> <!> <!></div>'),$t=n("Rules will be exported from this Elastic space to the <strong> </strong> branch in Git.",1),Ct=n(`Rules synced here will be saved to the <strong> </strong> branch.
							Use this for testing new rules before promoting to production.`,1),Gt=n("<option> </option>"),It=n('<select id="test-space" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select space...</option><!></select>'),Nt=n('<input id="test-space" type="text" placeholder="test" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/>'),Bt=n('<div class="space-y-4"><div class="flex items-center gap-3"><div class="p-2 bg-yellow-100 rounded-lg"><!></div> <div><h2 class="text-xl font-semibold text-gray-900"> </h2> <p class="text-sm text-gray-500"> </p></div></div> <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800"><!></p></div> <div><label for="test-space" class="block text-sm font-medium text-gray-700 mb-2">Elastic Space (Test) *</label> <!></div> <div><label for="test-branch" class="block text-sm font-medium text-gray-700 mb-2">Git Branch (Test) *</label> <input id="test-branch" type="text" placeholder="develop" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Branch where test rules will be synced (e.g., develop, staging)</p></div></div>'),Mt=n("<option> </option>"),Tt=n('<select id="prod-space" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select space...</option><!></select>'),At=n('<input id="prod-space" type="text" placeholder="default" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/>'),qt=n(`<div class="space-y-4"><div class="flex items-center gap-3"><div class="p-2 bg-green-100 rounded-lg"><!></div> <div><h2 class="text-xl font-semibold text-gray-900">Production Environment</h2> <p class="text-sm text-gray-500">Configure the production environment</p></div></div> <div class="bg-green-50 border border-green-200 rounded-lg p-4"><p class="text-sm text-green-800">Rules synced here will be saved to the <strong> </strong> branch.
						Changes require a Merge Request from <strong> </strong>.</p></div> <div><label for="prod-space" class="block text-sm font-medium text-gray-700 mb-2">Elastic Space (Production) *</label> <!></div> <div><label for="prod-branch" class="block text-sm font-medium text-gray-700 mb-2">Git Branch (Production) *</label> <input id="prod-branch" type="text" placeholder="main" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Protected branch for production rules (e.g., main, master)</p></div></div>`),Ft=n('<button class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Next <!></button>'),Dt=n('<div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>'),Ot=n('<button class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!> Create Project</button>'),zt=n('<div class="max-w-3xl mx-auto space-y-6"><div><a href="/projects" class="inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4"><!> Back to Projects</a> <h1 class="text-3xl font-bold text-gray-900">Create New Project</h1> <p class="mt-1 text-sm text-gray-500">Configure Test and Production environments for your detection rules</p></div> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-center justify-between mb-8"></div> <!> <!> <!> <!> <!> <div class="flex items-center justify-between mt-8 pt-6 border-t border-gray-200"><button class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!> Previous</button> <!></div></div></div>');function rr(X,F){it(F,!0);let v=j(1),h=j("full"),T=K(()=>e(h)==="export_only"?3:4),ue=K(()=>e(h)==="export_only"?["Project Info","Connections","Environment"]:["Project Info","Connections","Test Environment","Prod Environment"]),A=j(""),D=j(""),O=j(""),de=j(""),be=j(""),z=j(""),L=j("develop"),H=j(""),Y=j("main"),ce=j(ye([])),fe=j(ye([])),Z=j(ye([])),ve=j(!1),ee=j(""),De=K(()=>e(A).trim().length>0),Oe=K(()=>e(O)!==""&&e(de)!==""),ze=K(()=>e(z)!==""&&e(L).trim().length>0),Le=K(()=>e(H)!==""&&e(Y).trim().length>0);lt(async()=>{await Ue()});async function Ue(){try{u(ce,await ie.collection("elastic_instances").getFullList({filter:"is_active = true"}),!0),u(fe,await ie.collection("git_repositories").getFullList({filter:"is_active = true"}),!0)}catch(o){u(ee,o.message,!0)}}async function Ve(){if(e(O))try{const o=e(ce).find(s=>s.id===e(O));o&&o.spaces&&u(Z,o.spaces,!0)}catch(o){console.error("Failed to load spaces:",o)}}Ge(()=>{e(O)&&Ve()}),Ge(()=>{e(v)>e(T)&&u(v,e(T),!0)});function We(){e(v)<e(T)&&Ie(v)}function He(){e(v)>1&&Ie(v,-1)}async function Je(){try{u(ve,!0),u(ee,"");const o={name:e(A),description:e(D),elastic_instance:e(O),elastic_space:e(z),git_repository:e(de),git_path:e(be)||void 0,is_active:!0,sync_enabled:!0,sync_mode:e(h)},s=await ie.collection("projects").create(o);await ie.collection("environments").create({project:s.id,name:"test",elastic_space:e(z),git_branch:e(L),requires_approval:!1,auto_deploy:!0}),e(h)==="full"&&await ie.collection("environments").create({project:s.id,name:"production",elastic_space:e(H),git_branch:e(Y),requires_approval:!0,auto_deploy:!1}),ut("/projects/"+s.id)}catch(o){u(ee,o.message,!0)}finally{u(ve,!1)}}function he(o){switch(o){case 1:return e(De);case 2:return e(Oe);case 3:return e(ze);case 4:return e(Le);default:return!1}}var ge=zt();pt("1ytgd2c",o=>{dt(()=>{ct.title="New Project - Elastic Git Sync"})});var _e=r(ge),we=r(_e),Ke=r(we);Ne(Ke,{class:"w-4 h-4"}),M(),t(we),M(4),t(_e);var Pe=a(_e,2),me=r(Pe);oe(me,21,()=>Array(e(T)),se,(o,s,l)=>{var b=xt(),S=r(b),d=r(S),E=r(d);{var G=f=>{Be(f,{class:"w-5 h-5 text-white"})},c=f=>{var P=_t();P.textContent=l+1,i(f,P)};C(E,f=>{e(v)>l+1?f(G):f(c,!1)})}t(d);var p=a(d,2),g=r(p,!0);t(p),t(S);var w=a(S,2);{var B=f=>{var P=mt();$(()=>le(P,1,`flex-1 h-1 mx-4 rounded -mt-6
							${e(v)>l+1?"bg-blue-600":"bg-gray-200"}`)),i(f,P)};C(w,f=>{l<e(T)-1&&f(B)})}t(b),$(()=>{le(d,1,`flex items-center justify-center w-10 h-10 rounded-full border-2 transition-colors
							${e(v)>l+1?"bg-blue-600 border-blue-600":e(v)===l+1?"border-blue-600 text-blue-600":"border-gray-300 text-gray-400"}`),le(p,1,`mt-2 text-xs font-medium text-center ${e(v)>=l+1?"text-blue-600":"text-gray-400"}`),N(g,e(ue)[l])}),i(o,b)}),t(me);var ke=a(me,2);{var Qe=o=>{var s=yt(),l=r(s),b=r(l,!0);t(l),t(s),$(()=>N(b,e(ee))),i(o,s)};C(ke,o=>{e(ee)&&o(Qe)})}var je=a(ke,2);{var Xe=o=>{var s=ht(),l=a(r(s),2),b=a(r(l),2);Q(b),t(l);var S=a(l,2),d=a(r(S),2);vt(d),t(S);var E=a(S,2),G=a(r(E),2),c=r(G),p=a(c,2);t(G),t(E),t(s),$(()=>{le(c,1,`flex flex-col items-start p-4 border-2 rounded-lg transition-colors
								${e(h)==="full"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"}`),le(p,1,`flex flex-col items-start p-4 border-2 rounded-lg transition-colors
								${e(h)==="export_only"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"}`)}),W(b,()=>e(A),g=>u(A,g)),W(d,()=>e(D),g=>u(D,g)),ae("click",c,()=>u(h,"full")),ae("click",p,()=>u(h,"export_only")),i(o,s)};C(je,o=>{e(v)===1&&o(Xe)})}var Se=a(je,2);{var Ye=o=>{var s=Rt(),l=a(r(s),4);{var b=c=>{var p=wt();i(c,p)},S=c=>{var p=kt(),g=a(r(p),2),w=r(g);w.value=w.__value="";var B=a(w);oe(B,17,()=>e(ce),se,(f,P)=>{var R=Pt(),I=r(R,!0);t(R);var x={};$(()=>{N(I,e(P).name),x!==(x=e(P).id)&&(R.value=(R.__value=e(P).id)??"")}),i(f,R)}),t(g),t(p),pe(g,()=>e(O),f=>u(O,f)),i(c,p)};C(l,c=>{e(ce).length===0?c(b):c(S,!1)})}var d=a(l,2);{var E=c=>{var p=jt();i(c,p)},G=c=>{var p=Et(),g=ne(p),w=a(r(g),2),B=r(w);B.value=B.__value="";var f=a(B);oe(f,17,()=>e(fe),se,(I,x)=>{var k=St(),q=r(k,!0);t(k);var U={};$(()=>{N(q,e(x).name),U!==(U=e(x).id)&&(k.value=(k.__value=e(x).id)??"")}),i(I,k)}),t(w),t(g);var P=a(g,2),R=a(r(P),2);Q(R),M(2),t(P),pe(w,()=>e(de),I=>u(de,I)),W(R,()=>e(be),I=>u(be,I)),i(c,p)};C(d,c=>{e(fe).length===0?c(E):c(G,!1)})}t(s),i(o,s)};C(Se,o=>{e(v)===2&&o(Ye)})}var Ee=a(Se,2);{var Ze=o=>{var s=Bt(),l=r(s),b=r(l),S=r(b);bt(S,{class:"w-6 h-6 text-yellow-600"}),t(b);var d=a(b,2),E=r(d),G=r(E,!0);t(E);var c=a(E,2),p=r(c,!0);t(c),t(d),t(l);var g=a(l,2),w=r(g),B=r(w);{var f=_=>{var m=$t(),y=a(ne(m)),V=r(y,!0);t(y),M(),$(()=>N(V,e(L)||"develop")),i(_,m)},P=_=>{var m=Ct(),y=a(ne(m)),V=r(y,!0);t(y),M(),$(()=>N(V,e(L)||"develop")),i(_,m)};C(B,_=>{e(h)==="export_only"?_(f):_(P,!1)})}t(w),t(g);var R=a(g,2),I=a(r(R),2);{var x=_=>{var m=It(),y=r(m);y.value=y.__value="";var V=a(y);oe(V,17,()=>e(Z),se,(J,xe)=>{var re=Gt(),st=r(re,!0);t(re);var Ce={};$(()=>{N(st,e(xe)),Ce!==(Ce=e(xe))&&(re.value=(re.__value=e(xe))??"")}),i(J,re)}),t(m),pe(m,()=>e(z),J=>u(z,J)),i(_,m)},k=_=>{var m=Nt();Q(m),W(m,()=>e(z),y=>u(z,y)),i(_,m)};C(I,_=>{e(Z).length>0?_(x):_(k,!1)})}t(R);var q=a(R,2),U=a(r(q),2);Q(U),M(2),t(q),t(s),$(()=>{N(G,e(h)==="export_only"?"Environment":"Test Environment"),N(p,e(h)==="export_only"?"Configure the Elastic space and Git branch for exporting rules":"Configure the development/test environment")}),W(U,()=>e(L),_=>u(L,_)),i(o,s)};C(Ee,o=>{e(v)===3&&o(Ze)})}var Re=a(Ee,2);{var et=o=>{var s=qt(),l=r(s),b=r(l),S=r(b);ft(S,{class:"w-6 h-6 text-green-600"}),t(b),M(2),t(l);var d=a(l,2),E=r(d),G=a(r(E)),c=r(G,!0);t(G);var p=a(G,2),g=r(p,!0);t(p),M(),t(E),t(d);var w=a(d,2),B=a(r(w),2);{var f=x=>{var k=Tt(),q=r(k);q.value=q.__value="";var U=a(q);oe(U,17,()=>e(Z),se,(_,m)=>{var y=Mt(),V=r(y,!0);t(y);var J={};$(()=>{N(V,e(m)),J!==(J=e(m))&&(y.value=(y.__value=e(m))??"")}),i(_,y)}),t(k),pe(k,()=>e(H),_=>u(H,_)),i(x,k)},P=x=>{var k=At();Q(k),W(k,()=>e(H),q=>u(H,q)),i(x,k)};C(B,x=>{e(Z).length>0?x(f):x(P,!1)})}t(w);var R=a(w,2),I=a(r(R),2);Q(I),M(2),t(R),t(s),$(()=>{N(c,e(Y)||"main"),N(g,e(L)||"develop")}),W(I,()=>e(Y),x=>u(Y,x)),i(o,s)};C(Re,o=>{e(v)===4&&e(h)==="full"&&o(et)})}var $e=a(Re,2),te=r($e),tt=r(te);Ne(tt,{class:"w-4 h-4"}),M(),t(te);var rt=a(te,2);{var at=o=>{var s=Ft(),l=a(r(s));gt(l,{class:"w-4 h-4"}),t(s),$(b=>s.disabled=b,[()=>!he(e(v))]),ae("click",s,We),i(o,s)},ot=o=>{var s=Ot(),l=r(s);{var b=d=>{var E=Dt();i(d,E)},S=d=>{Be(d,{class:"w-4 h-4"})};C(l,d=>{e(ve)?d(b):d(S,!1)})}M(),t(s),$(d=>s.disabled=d,[()=>e(ve)||!he(e(v))]),ae("click",s,Je),i(o,s)};C(rt,o=>{e(v)<e(T)?o(at):o(ot,!1)})}t($e),t(Pe),t(ge),$(()=>te.disabled=e(v)===1),ae("click",te,He),i(X,ge),nt()}export{rr as component};

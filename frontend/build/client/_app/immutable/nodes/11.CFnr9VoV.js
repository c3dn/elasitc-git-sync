import"../chunks/CWj6FrbW.js";import{o as et,s as G}from"../chunks/CdzGu8ER.js";import{c as Ne,f as fe,a as n,p as tt,O as P,P as pe,Q as rt,h as e,t as $,j as ue,b as at,s as m,e as ot,g as r,d,$ as st,n as C,r as t,i as s,a1 as ke,T as it,S as se}from"../chunks/CbRa-Z4u.js";import{i as k}from"../chunks/CoDRCLiZ.js";import{I as Re,s as Ce,e as Z,i as ee,b as be,r as U,c as ie}from"../chunks/DZIrD1K_.js";import{h as lt}from"../chunks/Bj3l4WMm.js";import{b as z}from"../chunks/Bd-nUEkM.js";import{g as nt}from"../chunks/CilZWO1z.js";import{p as te}from"../chunks/VVSrSIoj.js";import{A as $e}from"../chunks/DqI1jT93.js";import"../chunks/DBRSZtkI.js";import{l as Ie,s as Be}from"../chunks/BjUZiTXz.js";import{T as dt,R as ct}from"../chunks/BWueu3Tx.js";function vt(H,D){const c=Ie(D,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];Re(H,Be({name:"arrow-right"},()=>c,{get iconNode(){return A},children:(J,L)=>{var B=Ne(),E=fe(B);Ce(E,D,"default",{}),n(J,B)},$$slots:{default:!0}}))}function Ee(H,D){const c=Ie(D,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M20 6 9 17l-5-5"}]];Re(H,Be({name:"check"},()=>c,{get iconNode(){return A},children:(J,L)=>{var B=Ne(),E=fe(B);Ce(E,D,"default",{}),n(J,B)},$$slots:{default:!0}}))}var pt=d('<span class="text-sm font-semibold"></span>'),ut=d("<div></div>"),bt=d('<div class="flex items-center flex-1"><div class="flex flex-col items-center"><div><!></div> <span> </span></div> <!></div>'),ft=d('<div class="mb-6 bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),gt=d('<div class="space-y-4"><h2 class="text-xl font-semibold text-gray-900">Basic Information</h2> <div><label for="name" class="block text-sm font-medium text-gray-700 mb-2">Project Name *</label> <input id="name" type="text" placeholder="My Security Rules Project" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/></div> <div><label for="description" class="block text-sm font-medium text-gray-700 mb-2">Description (optional)</label> <textarea id="description" placeholder="Describe this project..." rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"></textarea></div></div>'),_t=d('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800">No Elastic instances configured. Please add one in settings first.</p> <a href="/settings/elastic" class="text-sm text-blue-600 hover:underline mt-2 inline-block">Add Elastic Instance</a></div>'),mt=d("<option> </option>"),xt=d('<div><label for="elastic-instance" class="block text-sm font-medium text-gray-700 mb-2">Elastic Instance *</label> <select id="elastic-instance" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select instance...</option><!></select></div>'),yt=d('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800">No Git repositories configured. Please add one in settings first.</p> <a href="/settings/git" class="text-sm text-blue-600 hover:underline mt-2 inline-block">Add Git Repository</a></div>'),ht=d("<option> </option>"),wt=d('<div><label for="git-repo" class="block text-sm font-medium text-gray-700 mb-2">Git Repository *</label> <select id="git-repo" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select repository...</option><!></select></div> <div><label for="git-path" class="block text-sm font-medium text-gray-700 mb-2">Base Path in Repository (optional)</label> <input id="git-path" type="text" placeholder="detection-rules/" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Base directory for rules. Environments will have subdirectories.</p></div>',1),Pt=d('<div class="space-y-4"><h2 class="text-xl font-semibold text-gray-900">Connections</h2> <p class="text-sm text-gray-500">Select the Elastic instance and Git repository for this project.</p> <!> <!></div>'),jt=d("<option> </option>"),St=d('<select id="test-space" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select space...</option><!></select>'),kt=d('<input id="test-space" type="text" placeholder="test" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/>'),$t=d(`<div class="space-y-4"><div class="flex items-center gap-3"><div class="p-2 bg-yellow-100 rounded-lg"><!></div> <div><h2 class="text-xl font-semibold text-gray-900">Test Environment</h2> <p class="text-sm text-gray-500">Configure the development/test environment</p></div></div> <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800">Rules synced here will be saved to the <strong> </strong> branch.
						Use this for testing new rules before promoting to production.</p></div> <div><label for="test-space" class="block text-sm font-medium text-gray-700 mb-2">Elastic Space (Test) *</label> <!></div> <div><label for="test-branch" class="block text-sm font-medium text-gray-700 mb-2">Git Branch (Test) *</label> <input id="test-branch" type="text" placeholder="develop" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Branch where test rules will be synced (e.g., develop, staging)</p></div></div>`),Et=d("<option> </option>"),Nt=d('<select id="prod-space" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select space...</option><!></select>'),Rt=d('<input id="prod-space" type="text" placeholder="default" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/>'),Ct=d(`<div class="space-y-4"><div class="flex items-center gap-3"><div class="p-2 bg-green-100 rounded-lg"><!></div> <div><h2 class="text-xl font-semibold text-gray-900">Production Environment</h2> <p class="text-sm text-gray-500">Configure the production environment</p></div></div> <div class="bg-green-50 border border-green-200 rounded-lg p-4"><p class="text-sm text-green-800">Rules synced here will be saved to the <strong> </strong> branch.
						Changes require a Merge Request from <strong> </strong>.</p></div> <div><label for="prod-space" class="block text-sm font-medium text-gray-700 mb-2">Elastic Space (Production) *</label> <!></div> <div><label for="prod-branch" class="block text-sm font-medium text-gray-700 mb-2">Git Branch (Production) *</label> <input id="prod-branch" type="text" placeholder="main" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Protected branch for production rules (e.g., main, master)</p></div></div>`),It=d('<button class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Next <!></button>'),Bt=d('<div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>'),Tt=d('<button class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!> Create Project</button>'),Gt=d('<div class="max-w-3xl mx-auto space-y-6"><div><a href="/projects" class="inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4"><!> Back to Projects</a> <h1 class="text-3xl font-bold text-gray-900">Create New Project</h1> <p class="mt-1 text-sm text-gray-500">Configure Test and Production environments for your detection rules</p></div> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-center justify-between mb-8"></div> <!> <!> <!> <!> <!> <div class="flex items-center justify-between mt-8 pt-6 border-t border-gray-200"><button class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!> Previous</button> <!></div></div></div>');function Vt(H,D){tt(D,!0);let c=P(1);const A=4,J=["Project Info","Connections","Test Environment","Prod Environment"];let L=P(""),B=P(""),E=P(""),re=P(""),le=P(""),F=P(""),O=P("develop"),Q=P(""),K=P("main"),ae=P(pe([])),ne=P(pe([])),V=P(pe([])),oe=P(!1),W=P(""),Te=se(()=>e(L).trim().length>0),Ge=se(()=>e(E)!==""&&e(re)!==""),Ae=se(()=>e(F)!==""&&e(O).trim().length>0),Me=se(()=>e(Q)!==""&&e(K).trim().length>0);et(async()=>{await qe()});async function qe(){try{m(ae,await te.collection("elastic_instances").getFullList({filter:"is_active = true"}),!0),m(ne,await te.collection("git_repositories").getFullList({filter:"is_active = true"}),!0)}catch(a){m(W,a.message,!0)}}async function De(){if(e(E))try{const a=e(ae).find(o=>o.id===e(E));a&&a.spaces&&m(V,a.spaces,!0)}catch(a){console.error("Failed to load spaces:",a)}}rt(()=>{e(E)&&De()});function Fe(){e(c)<A&&ke(c)}function ze(){e(c)>1&&ke(c,-1)}async function Le(){try{m(oe,!0),m(W,"");const a={name:e(L),description:e(B),elastic_instance:e(E),elastic_space:e(F),git_repository:e(re),git_path:e(le)||void 0,is_active:!0,sync_enabled:!0},o=await te.collection("projects").create(a);await te.collection("environments").create({project:o.id,name:"test",elastic_space:e(F),git_branch:e(O),requires_approval:!1,auto_deploy:!0}),await te.collection("environments").create({project:o.id,name:"production",elastic_space:e(Q),git_branch:e(K),requires_approval:!0,auto_deploy:!1}),nt("/projects/"+o.id)}catch(a){m(W,a.message,!0)}finally{m(oe,!1)}}function ge(a){switch(a){case 1:return e(Te);case 2:return e(Ge);case 3:return e(Ae);case 4:return e(Me);default:return!1}}var de=Gt();lt("1ytgd2c",a=>{ot(()=>{st.title="New Project - Elastic Git Sync"})});var ce=r(de),_e=r(ce),Oe=r(_e);$e(Oe,{class:"w-4 h-4"}),C(),t(_e),C(4),t(ce);var me=s(ce,2),ve=r(me);Z(ve,21,()=>Array(A),ee,(a,o,i)=>{var b=bt(),j=r(b),l=r(j),h=r(l);{var I=p=>{Ee(p,{class:"w-5 h-5 text-white"})},g=p=>{var x=pt();x.textContent=i+1,n(p,x)};k(h,p=>{e(c)>i+1?p(I):p(g,!1)})}t(l);var v=s(l,2),S=r(v,!0);t(v),t(j);var w=s(j,2);{var N=p=>{var x=ut();$(()=>be(x,1,`flex-1 h-1 mx-4 rounded -mt-6
							${e(c)>i+1?"bg-blue-600":"bg-gray-200"}`)),n(p,x)};k(w,p=>{i<A-1&&p(N)})}t(b),$(()=>{be(l,1,`flex items-center justify-center w-10 h-10 rounded-full border-2 transition-colors
							${e(c)>i+1?"bg-blue-600 border-blue-600":e(c)===i+1?"border-blue-600 text-blue-600":"border-gray-300 text-gray-400"}`),be(v,1,`mt-2 text-xs font-medium text-center ${e(c)>=i+1?"text-blue-600":"text-gray-400"}`),G(S,J[i])}),n(a,b)}),t(ve);var xe=s(ve,2);{var Qe=a=>{var o=ft(),i=r(o),b=r(i,!0);t(i),t(o),$(()=>G(b,e(W))),n(a,o)};k(xe,a=>{e(W)&&a(Qe)})}var ye=s(xe,2);{var Ue=a=>{var o=gt(),i=s(r(o),2),b=s(r(i),2);U(b),t(i);var j=s(i,2),l=s(r(j),2);it(l),t(j),t(o),z(b,()=>e(L),h=>m(L,h)),z(l,()=>e(B),h=>m(B,h)),n(a,o)};k(ye,a=>{e(c)===1&&a(Ue)})}var he=s(ye,2);{var He=a=>{var o=Pt(),i=s(r(o),4);{var b=g=>{var v=_t();n(g,v)},j=g=>{var v=xt(),S=s(r(v),2),w=r(S);w.value=w.__value="";var N=s(w);Z(N,17,()=>e(ae),ee,(p,x)=>{var f=mt(),_=r(f,!0);t(f);var u={};$(()=>{G(_,e(x).name),u!==(u=e(x).id)&&(f.value=(f.__value=e(x).id)??"")}),n(p,f)}),t(S),t(v),ie(S,()=>e(E),p=>m(E,p)),n(g,v)};k(i,g=>{e(ae).length===0?g(b):g(j,!1)})}var l=s(i,2);{var h=g=>{var v=yt();n(g,v)},I=g=>{var v=wt(),S=fe(v),w=s(r(S),2),N=r(w);N.value=N.__value="";var p=s(N);Z(p,17,()=>e(ne),ee,(_,u)=>{var y=ht(),R=r(y,!0);t(y);var M={};$(()=>{G(R,e(u).name),M!==(M=e(u).id)&&(y.value=(y.__value=e(u).id)??"")}),n(_,y)}),t(w),t(S);var x=s(S,2),f=s(r(x),2);U(f),C(2),t(x),ie(w,()=>e(re),_=>m(re,_)),z(f,()=>e(le),_=>m(le,_)),n(g,v)};k(l,g=>{e(ne).length===0?g(h):g(I,!1)})}t(o),n(a,o)};k(he,a=>{e(c)===2&&a(He)})}var we=s(he,2);{var Je=a=>{var o=$t(),i=r(o),b=r(i),j=r(b);dt(j,{class:"w-6 h-6 text-yellow-600"}),t(b),C(2),t(i);var l=s(i,2),h=r(l),I=s(r(h)),g=r(I,!0);t(I),C(),t(h),t(l);var v=s(l,2),S=s(r(v),2);{var w=f=>{var _=St(),u=r(_);u.value=u.__value="";var y=s(u);Z(y,17,()=>e(V),ee,(R,M)=>{var T=jt(),Y=r(T,!0);t(T);var q={};$(()=>{G(Y,e(M)),q!==(q=e(M))&&(T.value=(T.__value=e(M))??"")}),n(R,T)}),t(_),ie(_,()=>e(F),R=>m(F,R)),n(f,_)},N=f=>{var _=kt();U(_),z(_,()=>e(F),u=>m(F,u)),n(f,_)};k(S,f=>{e(V).length>0?f(w):f(N,!1)})}t(v);var p=s(v,2),x=s(r(p),2);U(x),C(2),t(p),t(o),$(()=>G(g,e(O)||"develop")),z(x,()=>e(O),f=>m(O,f)),n(a,o)};k(we,a=>{e(c)===3&&a(Je)})}var Pe=s(we,2);{var Ke=a=>{var o=Ct(),i=r(o),b=r(i),j=r(b);ct(j,{class:"w-6 h-6 text-green-600"}),t(b),C(2),t(i);var l=s(i,2),h=r(l),I=s(r(h)),g=r(I,!0);t(I);var v=s(I,2),S=r(v,!0);t(v),C(),t(h),t(l);var w=s(l,2),N=s(r(w),2);{var p=u=>{var y=Nt(),R=r(y);R.value=R.__value="";var M=s(R);Z(M,17,()=>e(V),ee,(T,Y)=>{var q=Et(),Ze=r(q,!0);t(q);var Se={};$(()=>{G(Ze,e(Y)),Se!==(Se=e(Y))&&(q.value=(q.__value=e(Y))??"")}),n(T,q)}),t(y),ie(y,()=>e(Q),T=>m(Q,T)),n(u,y)},x=u=>{var y=Rt();U(y),z(y,()=>e(Q),R=>m(Q,R)),n(u,y)};k(N,u=>{e(V).length>0?u(p):u(x,!1)})}t(w);var f=s(w,2),_=s(r(f),2);U(_),C(2),t(f),t(o),$(()=>{G(g,e(K)||"main"),G(S,e(O)||"develop")}),z(_,()=>e(K),u=>m(K,u)),n(a,o)};k(Pe,a=>{e(c)===4&&a(Ke)})}var je=s(Pe,2),X=r(je),Ve=r(X);$e(Ve,{class:"w-4 h-4"}),C(),t(X);var We=s(X,2);{var Xe=a=>{var o=It(),i=s(r(o));vt(i,{class:"w-4 h-4"}),t(o),$(b=>o.disabled=b,[()=>!ge(e(c))]),ue("click",o,Fe),n(a,o)},Ye=a=>{var o=Tt(),i=r(o);{var b=l=>{var h=Bt();n(l,h)},j=l=>{Ee(l,{class:"w-4 h-4"})};k(i,l=>{e(oe)?l(b):l(j,!1)})}C(),t(o),$(l=>o.disabled=l,[()=>e(oe)||!ge(e(c))]),ue("click",o,Le),n(a,o)};k(We,a=>{e(c)<A?a(Xe):a(Ye,!1)})}t(je),t(me),t(de),$(()=>X.disabled=e(c)===1),ue("click",X,ze),n(H,de),at()}export{Vt as component};

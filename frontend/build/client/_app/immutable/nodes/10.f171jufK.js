import"../chunks/CWj6FrbW.js";import{o as Tt,s as D}from"../chunks/CdzGu8ER.js";import{c as Gt,f as Re,a as p,p as Bt,O as v,P as X,Q as Mt,h as e,t as S,b as At,s as o,R as Lt,g as a,d as _,$ as Ct,n as j,r,i,S as Dt,T as Ft,j as Ie}from"../chunks/CbRa-Z4u.js";import{i as k}from"../chunks/CoDRCLiZ.js";import{I as qt,s as zt,a as tt,r as P,e as Y,i as Z,c as O}from"../chunks/DZIrD1K_.js";import{h as Ht}from"../chunks/Bj3l4WMm.js";import{b as B,a as rt}from"../chunks/Bd-nUEkM.js";import{l as Ot,s as Vt,a as Nt,b as Qt}from"../chunks/BjUZiTXz.js";import{p as Ut}from"../chunks/HGTMDPNe.js";import"../chunks/CilZWO1z.js";import{p as h}from"../chunks/VVSrSIoj.js";import{A as Wt}from"../chunks/DqI1jT93.js";import{C as Jt}from"../chunks/x6-o1nLb.js";import{T as Kt,R as Xt}from"../chunks/BWueu3Tx.js";import{T as at}from"../chunks/IMcaUzhR.js";import{L as Yt}from"../chunks/B04TN2pU.js";import"../chunks/DBRSZtkI.js";function Zt(ee,V){const te=Ot(V,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];qt(ee,Vt({name:"save"},()=>te,{get iconNode(){return re},children:(ae,b)=>{var g=Gt(),M=Re(g);zt(M,V,"default",{}),p(ae,g)},$$slots:{default:!0}}))}var er=_('<div class="bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),tr=_('<div class="bg-green-50 border border-green-200 rounded-lg p-4"><p class="text-sm text-green-800"> </p></div>'),rr=_('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div></div>'),ar=_("<option> </option>"),or=_("<option> </option>"),sr=_(`<div><label for="sync-interval" class="block text-sm font-medium text-gray-700 mb-2">Sync Interval</label> <select id="sync-interval" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Every 5 minutes</option><option>Every 15 minutes</option><option>Every 30 minutes</option><option>Every hour</option><option>Every 2 hours</option><option>Every 6 hours</option><option>Every 12 hours</option><option>Every 24 hours</option></select></div> <div class="bg-blue-50 border border-blue-200 rounded-lg p-3"><p class="text-sm text-blue-800">When enabled, rules from your Test environment will be automatically exported to Git at the selected interval.
							This only exports from Elastic to Git - it does not import rules to Production.</p></div>`,1),ir=_('<button class="text-red-600 hover:text-red-700 text-sm"><!></button>'),lr=_("<option> </option>"),nr=_('<select id="test-space" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select space...</option><!></select>'),dr=_('<input id="test-space" type="text" placeholder="test" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/>'),cr=_('<button class="text-red-600 hover:text-red-700 text-sm"><!></button>'),vr=_("<option> </option>"),ur=_('<select id="prod-space" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"><option>Select space...</option><!></select>'),pr=_('<input id="prod-space" type="text" placeholder="default" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/>'),_r=_('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><h2 class="text-lg font-semibold text-gray-900 mb-4">Project Details</h2> <div class="space-y-4"><div><label for="name" class="block text-sm font-medium text-gray-700 mb-2">Project Name *</label> <input id="name" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/></div> <div><label for="description" class="block text-sm font-medium text-gray-700 mb-2">Description</label> <textarea id="description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"></textarea></div> <div class="grid grid-cols-2 gap-4"><div><label for="elastic" class="block text-sm font-medium text-gray-700 mb-2">Elastic Instance *</label> <select id="elastic" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"></select></div> <div><label for="git" class="block text-sm font-medium text-gray-700 mb-2">Git Repository *</label> <select id="git" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"></select></div></div> <div><label for="path" class="block text-sm font-medium text-gray-700 mb-2">Base Path in Repository</label> <input id="path" type="text" placeholder="detection-rules/" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/></div> <div class="flex items-center gap-2"><input id="active" type="checkbox" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-600"/> <label for="active" class="text-sm font-medium text-gray-700">Project is active</label></div></div></div> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-center gap-3 mb-4"><div class="p-2 bg-blue-100 rounded-lg"><!></div> <div><h2 class="text-lg font-semibold text-gray-900">Automatic Sync</h2> <p class="text-sm text-gray-500">Schedule automatic rule exports to Git</p></div></div> <div class="space-y-4"><div class="flex items-center gap-2"><input id="sync-enabled" type="checkbox" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-600"/> <label for="sync-enabled" class="text-sm font-medium text-gray-700">Enable automatic sync</label></div> <!></div></div> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="p-2 bg-yellow-100 rounded-lg"><!></div> <div><h2 class="text-lg font-semibold text-gray-900">Test Environment</h2> <p class="text-sm text-gray-500">Development and testing configuration</p></div></div> <!></div> <div class="grid grid-cols-2 gap-4"><div><label for="test-space" class="block text-sm font-medium text-gray-700 mb-2">Elastic Space</label> <!></div> <div><label for="test-branch" class="block text-sm font-medium text-gray-700 mb-2">Git Branch</label> <input id="test-branch" type="text" placeholder="develop" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/></div></div></div> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="p-2 bg-green-100 rounded-lg"><!></div> <div><h2 class="text-lg font-semibold text-gray-900">Production Environment</h2> <p class="text-sm text-gray-500">Production configuration (requires MR)</p></div></div> <!></div> <div class="grid grid-cols-2 gap-4"><div><label for="prod-space" class="block text-sm font-medium text-gray-700 mb-2">Elastic Space</label> <!></div> <div><label for="prod-branch" class="block text-sm font-medium text-gray-700 mb-2">Git Branch</label> <input id="prod-branch" type="text" placeholder="main" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"/></div></div></div> <div class="flex items-center gap-4"><button class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"><!> Save Changes</button> <a class="px-6 py-3 text-gray-700 hover:text-gray-900 transition-colors">Cancel</a></div>',1),fr=_('<div class="max-w-3xl mx-auto space-y-6"><div><a class="inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4"><!> Back to Project</a> <h1 class="text-3xl font-bold text-gray-900">Edit Project</h1> <p class="mt-1 text-sm text-gray-500">Update project settings and environment configuration</p></div> <!> <!> <!></div>');function Br(ee,V){Bt(V,!0);const te=()=>Qt(Ut,"$page",re),[re,ae]=Nt();let b=v(null),g=v(X([])),M=v(X([])),Te=v(X([])),F=v(X([])),oe=v(!0),N=v(!1),A=v(""),Q=v(""),q=v(""),U=v(""),$=v(""),z=v(""),W=v(""),J=v(!0),L=v(!1),K=v(0),x=v(""),I=v(""),w=v(""),R=v(""),T=Dt(()=>te().params.id);Tt(async()=>{await se()});async function se(){try{o(oe,!0),o(b,await h.collection("projects").getOne(e(T),{expand:"elastic_instance,git_repository"}),!0),o(q,e(b).name,!0),o(U,e(b).description||"",!0),o($,e(b).elastic_instance,!0),o(z,e(b).git_repository,!0),o(W,e(b).git_path||"",!0),o(J,e(b).is_active,!0),o(L,e(b).sync_enabled||!1,!0),o(K,e(b).auto_sync_interval||0,!0),o(g,await h.collection("environments").getFullList({filter:`project = "${e(T)}"`}),!0);const l=e(g).find(c=>c.name==="test"),d=e(g).find(c=>c.name==="production");l&&(o(x,l.elastic_space,!0),o(I,l.git_branch,!0)),d&&(o(w,d.elastic_space,!0),o(R,d.git_branch,!0)),o(M,await h.collection("elastic_instances").getFullList({filter:"is_active = true"}),!0),o(Te,await h.collection("git_repositories").getFullList({filter:"is_active = true"}),!0),await Ge()}catch(l){o(A,l.message,!0)}finally{o(oe,!1)}}async function Ge(){if(e($))try{const l=e(M).find(d=>d.id===e($));l&&l.spaces&&o(F,l.spaces,!0)}catch(l){console.error("Failed to load spaces:",l)}}Mt(()=>{e($)&&e(M).length>0&&Ge()});async function ot(){try{o(N,!0),o(A,""),o(Q,""),await h.collection("projects").update(e(T),{name:e(q),description:e(U)||"",elastic_instance:e($),elastic_space:e(x),git_repository:e(z),git_path:e(W)||"",is_active:e(J),sync_enabled:e(L),auto_sync_interval:e(L)?e(K):0});const l=e(g).find(c=>c.name==="test");l?await h.collection("environments").update(l.id,{elastic_space:e(x),git_branch:e(I)}):e(x)&&e(I)&&await h.collection("environments").create({project:e(T),name:"test",elastic_space:e(x),git_branch:e(I),requires_approval:!1,auto_deploy:!0});const d=e(g).find(c=>c.name==="production");d?await h.collection("environments").update(d.id,{elastic_space:e(w),git_branch:e(R)}):e(w)&&e(R)&&await h.collection("environments").create({project:e(T),name:"production",elastic_space:e(w),git_branch:e(R),requires_approval:!0,auto_deploy:!1}),o(Q,"Project saved successfully!"),await se()}catch(l){o(A,l.message,!0)}finally{o(N,!1)}}async function Be(l){const d=e(g).find(c=>c.name===l);if(d&&confirm(`Are you sure you want to delete the ${l} environment?`))try{await h.collection("environments").delete(d.id),l==="test"?(o(x,""),o(I,"")):(o(w,""),o(R,"")),await se()}catch(c){o(A,c.message,!0)}}var ie=fr();Ht("1h9ouny",l=>{Lt(()=>{var d;Ct.title=`Edit ${(((d=e(b))==null?void 0:d.name)||"Project")??""} - Elastic Git Sync`})});var le=a(ie),ne=a(le),st=a(ne);Wt(st,{class:"w-4 h-4"}),j(),r(ne),j(4),r(le);var Me=i(le,2);{var it=l=>{var d=er(),c=a(d),C=a(c,!0);r(c),r(d),S(()=>D(C,e(A))),p(l,d)};k(Me,l=>{e(A)&&l(it)})}var Ae=i(Me,2);{var lt=l=>{var d=tr(),c=a(d),C=a(c,!0);r(c),r(d),S(()=>D(C,e(Q))),p(l,d)};k(Ae,l=>{e(Q)&&l(lt)})}var nt=i(Ae,2);{var dt=l=>{var d=rr();p(l,d)},ct=l=>{var d=_r(),c=Re(d),C=i(a(c),2),de=a(C),Le=i(a(de),2);P(Le),r(de);var ce=i(de,2),Ce=i(a(ce),2);Ft(Ce),r(ce);var ve=i(ce,2),ue=a(ve),pe=i(a(ue),2);Y(pe,21,()=>e(M),Z,(t,s)=>{var n=ar(),m=a(n,!0);r(n);var u={};S(()=>{D(m,e(s).name),u!==(u=e(s).id)&&(n.value=(n.__value=e(s).id)??"")}),p(t,n)}),r(pe),r(ue);var De=i(ue,2),_e=i(a(De),2);Y(_e,21,()=>e(Te),Z,(t,s)=>{var n=or(),m=a(n,!0);r(n);var u={};S(()=>{D(m,e(s).name),u!==(u=e(s).id)&&(n.value=(n.__value=e(s).id)??"")}),p(t,n)}),r(_e),r(De),r(ve);var fe=i(ve,2),Fe=i(a(fe),2);P(Fe),r(fe);var qe=i(fe,2),ze=a(qe);P(ze),j(2),r(qe),r(C),r(c);var be=i(c,2),ge=a(be),He=a(ge),vt=a(He);Jt(vt,{class:"w-5 h-5 text-blue-600"}),r(He),j(2),r(ge);var Oe=i(ge,2),me=a(Oe),Ve=a(me);P(Ve),j(2),r(me);var ut=i(me,2);{var pt=t=>{var s=sr(),n=Re(s),m=i(a(n),2),u=a(m);u.value=u.__value=5;var y=i(u);y.value=y.__value=15;var f=i(y);f.value=f.__value=30;var G=i(f);G.value=G.__value=60;var E=i(G);E.value=E.__value=120;var Se=i(E);Se.value=Se.__value=360;var Pe=i(Se);Pe.value=Pe.__value=720;var et=i(Pe);et.value=et.__value=1440,r(m),r(n),j(2),O(m,()=>e(K),Rt=>o(K,Rt)),p(t,s)};k(ut,t=>{e(L)&&t(pt)})}r(Oe),r(be);var ye=i(be,2),xe=a(ye),he=a(xe),Ne=a(he),_t=a(Ne);Kt(_t,{class:"w-5 h-5 text-yellow-600"}),r(Ne),j(2),r(he);var ft=i(he,2);{var bt=t=>{var s=ir(),n=a(s);at(n,{class:"w-4 h-4"}),r(s),Ie("click",s,()=>Be("test")),p(t,s)};k(ft,t=>{e(g).find(s=>s.name==="test")&&t(bt)})}r(xe);var Qe=i(xe,2),we=a(Qe),gt=i(a(we),2);{var mt=t=>{var s=nr(),n=a(s);n.value=n.__value="";var m=i(n);Y(m,17,()=>e(F),Z,(u,y)=>{var f=lr(),G=a(f,!0);r(f);var E={};S(()=>{D(G,e(y)),E!==(E=e(y))&&(f.value=(f.__value=e(y))??"")}),p(u,f)}),r(s),O(s,()=>e(x),u=>o(x,u)),p(t,s)},yt=t=>{var s=dr();P(s),B(s,()=>e(x),n=>o(x,n)),p(t,s)};k(gt,t=>{e(F).length>0?t(mt):t(yt,!1)})}r(we);var Ue=i(we,2),We=i(a(Ue),2);P(We),r(Ue),r(Qe),r(ye);var Ee=i(ye,2),je=a(Ee),ke=a(je),Je=a(ke),xt=a(Je);Xt(xt,{class:"w-5 h-5 text-green-600"}),r(Je),j(2),r(ke);var ht=i(ke,2);{var wt=t=>{var s=cr(),n=a(s);at(n,{class:"w-4 h-4"}),r(s),Ie("click",s,()=>Be("production")),p(t,s)};k(ht,t=>{e(g).find(s=>s.name==="production")&&t(wt)})}r(je);var Ke=i(je,2),$e=a(Ke),Et=i(a($e),2);{var jt=t=>{var s=ur(),n=a(s);n.value=n.__value="";var m=i(n);Y(m,17,()=>e(F),Z,(u,y)=>{var f=vr(),G=a(f,!0);r(f);var E={};S(()=>{D(G,e(y)),E!==(E=e(y))&&(f.value=(f.__value=e(y))??"")}),p(u,f)}),r(s),O(s,()=>e(w),u=>o(w,u)),p(t,s)},kt=t=>{var s=pr();P(s),B(s,()=>e(w),n=>o(w,n)),p(t,s)};k(Et,t=>{e(F).length>0?t(jt):t(kt,!1)})}r($e);var Xe=i($e,2),Ye=i(a(Xe),2);P(Ye),r(Xe),r(Ke),r(Ee);var Ze=i(Ee,2),H=a(Ze),$t=a(H);{var St=t=>{Yt(t,{class:"w-5 h-5 animate-spin"})},Pt=t=>{Zt(t,{class:"w-5 h-5"})};k($t,t=>{e(N)?t(St):t(Pt,!1)})}j(),r(H);var It=i(H,2);r(Ze),S(()=>{H.disabled=e(N)||!e(q)||!e($)||!e(z),tt(It,"href",`/projects/${e(T)??""}`)}),B(Le,()=>e(q),t=>o(q,t)),B(Ce,()=>e(U),t=>o(U,t)),O(pe,()=>e($),t=>o($,t)),O(_e,()=>e(z),t=>o(z,t)),B(Fe,()=>e(W),t=>o(W,t)),rt(ze,()=>e(J),t=>o(J,t)),rt(Ve,()=>e(L),t=>o(L,t)),B(We,()=>e(I),t=>o(I,t)),B(Ye,()=>e(R),t=>o(R,t)),Ie("click",H,ot),p(l,d)};k(nt,l=>{e(oe)?l(dt):l(ct,!1)})}r(ie),S(()=>tt(ne,"href",`/projects/${e(T)??""}`)),p(ee,ie),At(),ae()}export{Br as component};

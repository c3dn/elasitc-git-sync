import"../chunks/CWj6FrbW.js";import{i as Oe}from"../chunks/COK2pY8o.js";import{o as Re,s as I}from"../chunks/BnHnlVXU.js";import{p as De,a as d,b as Ke,e as Ne,d as b,s as a,$ as $e,h as s,i as e,g as n,r,m as p,n as C,j,t as Y,c as be,f as ge,l as Je}from"../chunks/BbuzmxRY.js";import{i as u}from"../chunks/XgF_cVEg.js";import{r as Z,a as Me,e as Ve,b as Ye,i as Be}from"../chunks/Bm_MFDQ1.js";import{h as He}from"../chunks/BwaF3Q6U.js";import{b as ce,a as qe}from"../chunks/BjJ5yzjH.js";import{p as S}from"../chunks/BVZH3wAp.js";import{P as ze}from"../chunks/D_FWaIFH.js";import{L as ye}from"../chunks/Cr7rThFx.js";import{R as _e,P as Ge}from"../chunks/CfIP2vrm.js";import{T as Qe}from"../chunks/-YWqKXAd.js";import{C as We}from"../chunks/C4YxXooL.js";import{C as Xe}from"../chunks/B5_3TA3C.js";var Ze=b('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800 font-medium">SSL certificate verification is disabled</p> <p class="text-xs text-yellow-700 mt-1">The DISABLE_SSL_VERIFY environment variable is set to true. All outgoing HTTPS connections skip certificate verification.</p></div>'),et=b('<button class="inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors"><!> Add Elastic Instance</button>'),tt=b('<div class="mb-4 bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),at=b('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4"> </h3> <!> <div class="space-y-4"><div><label for="name" class="block text-sm font-medium text-gray-700 mb-2">Instance Name *</label> <input id="name" type="text" placeholder="Production Elastic" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/></div> <div><label for="url" class="block text-sm font-medium text-gray-700 mb-2">Elastic URL *</label> <input id="url" type="url" placeholder="https://your-elastic.cloud" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Full URL to your Elastic instance</p></div> <div><label for="api-key" class="block text-sm font-medium text-gray-700 mb-2"> </label> <input id="api-key" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Create an API key in Kibana: Stack Management → API Keys</p></div> <div class="flex items-center gap-2"><input id="is-active" type="checkbox" class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-600"/> <label for="is-active" class="text-sm font-medium text-gray-700">Active</label></div> <div class="flex items-center gap-3 pt-4"><button class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!> Test Connection</button> <button class="inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button> <button class="px-4 py-2 text-gray-700 hover:text-gray-900 transition-colors">Cancel</button></div></div></div>'),rt=b('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div></div>'),st=b('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"><p class="text-gray-500">No Elastic instances configured yet.</p></div>'),it=b('<p class="text-xs text-gray-500"> </p>'),ot=b('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3 mb-2"><h3 class="text-lg font-semibold text-gray-900"> </h3> <!></div> <p class="text-sm text-gray-600 mb-2"> </p> <!></div> <div class="flex items-center gap-2"><span> </span></div></div> <div class="flex items-center gap-2 mt-4 pt-4 border-t border-gray-200"><button class="inline-flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm"><!> Test Connection</button> <button class="inline-flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm"><!> Edit</button> <button class="ml-auto inline-flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm"><!> Delete</button></div></div>'),nt=b('<div class="space-y-4"></div>'),lt=b('<div class="space-y-6"><!> <!> <!> <!></div>');function It(xe,he){De(he,!1);let B=p([]),F=p(!1),E=p(!1),H=p(!1),f=p(""),g=p(null),de=p(!1),L=p(""),_=p(""),x=p(""),D=p(!0);Re(async()=>{await q();try{const o=await(await fetch(`${S.baseUrl}/api/settings/ssl-status`)).json();a(de,o.ssl_verification_disabled)}catch{}});async function q(){try{a(E,!0),a(B,await S.collection("elastic_instances").getFullList({sort:"-created"}))}catch(t){a(f,t.message)}finally{a(E,!1)}}function ve(){a(L,""),a(_,""),a(x,""),a(D,!0),a(g,null),a(f,"")}function we(){ve(),a(F,!0)}function ke(t){a(g,t.id),a(L,t.name),a(_,t.url),a(x,t.api_key),a(D,t.is_active),a(f,""),a(F,!0)}function pe(){a(F,!1),ve()}async function Ie(){var t;try{a(H,!0),a(f,"");const c=await(await fetch(`${S.baseUrl}/api/connection/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"elastic",config:{url:e(_),api_key:e(x)}})})).json();c.success?alert(`Connection successful! Found ${((t=c.spaces)==null?void 0:t.length)||0} spaces.`):a(f,c.message)}catch(o){a(f,o.message)}finally{a(H,!1)}}async function Ce(){try{a(E,!0),a(f,"");const t={name:e(L),url:e(_),api_key:e(x),is_active:e(D)};e(g)?await S.collection("elastic_instances").update(e(g),t):await S.collection("elastic_instances").create(t),pe(),await q()}catch(t){a(f,t.message)}finally{a(E,!1)}}async function Se(t){if(confirm("Are you sure you want to delete this instance?"))try{await S.collection("elastic_instances").delete(t),await q()}catch(o){alert(`Error: ${o.message}`)}}async function Ee(t){try{const c=await(await fetch(`${S.baseUrl}/api/connection/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"elastic",config:{url:t.url,api_key:t.api_key}})})).json();await S.collection("elastic_instances").update(t.id,{connection_status:c.success?"success":"failed",last_connection_test:new Date().toISOString(),spaces:c.spaces||[]}),await q()}catch(o){console.error("Connection test failed:",o)}}Oe();var ee=lt();He("21ec2",t=>{Ne(()=>{$e.title="Elastic Instances - Settings"})});var ue=s(ee);{var Ae=t=>{var o=Ze();d(t,o)};u(ue,t=>{e(de)&&t(Ae)})}var fe=n(ue,2);{var Pe=t=>{var o=et(),c=s(o);ze(c,{class:"w-5 h-5"}),C(),r(o),j("click",o,we),d(t,o)};u(fe,t=>{e(F)||t(Pe)})}var me=n(fe,2);{var Te=t=>{var o=at(),c=s(o),te=s(c,!0);r(c);var z=n(c,2);{var h=i=>{var v=tt(),X=s(v),V=s(X,!0);r(X),r(v),Y(()=>I(V,e(f))),d(i,v)};u(z,i=>{e(f)&&i(h)})}var w=n(z,2),K=s(w),l=n(s(K),2);Z(l),r(K);var A=n(K,2),U=n(s(A),2);Z(U),C(2),r(A);var P=n(A,2),T=s(P),N=s(T);r(T);var $=n(T,2);Z($),C(2),r(P);var J=n(P,2),G=s(J);Z(G),C(2),r(J);var Q=n(J,2),y=s(Q),ae=s(y);{var re=i=>{ye(i,{class:"w-4 h-4 animate-spin"})},se=i=>{_e(i,{class:"w-4 h-4"})};u(ae,i=>{e(H)?i(re):i(se,!1)})}C(),r(y);var k=n(y,2),M=s(k);{var ie=i=>{ye(i,{class:"w-4 h-4 animate-spin"})},W=i=>{var v=Je();Y(()=>I(v,e(g)?"Update":"Save")),d(i,v)};u(M,i=>{e(E)?i(ie):i(W,!1)})}r(k);var O=n(k,2);r(Q),r(w),r(o),Y(()=>{I(te,e(g)?"Edit Elastic Instance":"Add Elastic Instance"),I(N,`API Key ${e(g)?"(leave empty to keep current)":"*"}`),Me($,"placeholder",e(g)?"••••••••":"Your Elastic API key"),y.disabled=!e(_)||!e(x)||e(H),k.disabled=e(E)||!e(L)||!e(_)||!e(g)&&!e(x)}),ce(l,()=>e(L),i=>a(L,i)),ce(U,()=>e(_),i=>a(_,i)),ce($,()=>e(x),i=>a(x,i)),qe(G,()=>e(D),i=>a(D,i)),j("click",y,Ie),j("click",k,Ce),j("click",O,pe),d(t,o)};u(me,t=>{e(F)&&t(Te)})}var je=n(me,2);{var Fe=t=>{var o=rt();d(t,o)},Le=t=>{var o=be(),c=ge(o);{var te=h=>{var w=st();d(h,w)},z=h=>{var w=nt();Ve(w,5,()=>e(B),Be,(K,l)=>{var A=ot(),U=s(A),P=s(U),T=s(P),N=s(T),$=s(N,!0);r(N);var J=n(N,2);{var G=m=>{We(m,{class:"w-5 h-5 text-green-600"})},Q=m=>{var R=be(),oe=ge(R);{var ne=le=>{Xe(le,{class:"w-5 h-5 text-red-600"})};u(oe,le=>{e(l).connection_status==="failed"&&le(ne)},!0)}d(m,R)};u(J,m=>{e(l).connection_status==="success"?m(G):m(Q,!1)})}r(T);var y=n(T,2),ae=s(y,!0);r(y);var re=n(y,2);{var se=m=>{var R=it(),oe=s(R);r(R),Y(ne=>I(oe,`Spaces: ${ne??""}`),[()=>e(l).spaces.join(", ")]),d(m,R)};u(re,m=>{e(l).spaces&&e(l).spaces.length>0&&m(se)})}r(P);var k=n(P,2),M=s(k),ie=s(M,!0);r(M),r(k),r(U);var W=n(U,2),O=s(W),i=s(O);_e(i,{class:"w-4 h-4"}),C(),r(O);var v=n(O,2),X=s(v);Ge(X,{class:"w-4 h-4"}),C(),r(v);var V=n(v,2),Ue=s(V);Qe(Ue,{class:"w-4 h-4"}),C(),r(V),r(W),r(A),Y(()=>{I($,e(l).name),I(ae,e(l).url),Ye(M,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
								${e(l).is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`),I(ie,e(l).is_active?"Active":"Inactive")}),j("click",O,()=>Ee(e(l))),j("click",v,()=>ke(e(l))),j("click",V,()=>Se(e(l).id)),d(K,A)}),r(w),d(h,w)};u(c,h=>{e(B).length===0&&!e(F)?h(te):h(z,!1)},!0)}d(t,o)};u(je,t=>{e(E)&&e(B).length===0?t(Fe):t(Le,!1)})}r(ee),d(xe,ee),Ke()}export{It as component};

import"../chunks/CWj6FrbW.js";import{i as Re}from"../chunks/Dl2LfGm4.js";import{o as De,s as I}from"../chunks/O7RWNxBF.js";import{p as Ke,a as c,b as Ne,e as $e,d as b,s as a,$ as Je,h as s,i as e,g as n,r,m as p,n as C,j as F,t as Y,c as me,f as fe,o as Me}from"../chunks/C9NYA0Nw.js";import{i as g}from"../chunks/D2ldot_M.js";import{r as Z,b as Ve,e as Ye,a as Be,i as He}from"../chunks/rMS1oNTx.js";import{h as qe}from"../chunks/k5AYXn5z.js";import{b as de,a as ze}from"../chunks/DkcqxK1V.js";import{a as ce,p as S}from"../chunks/BUCyip3L.js";import{P as Ge}from"../chunks/DRykE2x8.js";import{L as xe}from"../chunks/suUg0HP9.js";import{R as _e,P as Qe}from"../chunks/CUX4yob5.js";import{T as We}from"../chunks/Bv-fdLbk.js";import{C as Xe}from"../chunks/CyniT6t_.js";import{C as Ze}from"../chunks/DJoU24lj.js";var et=b('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800 font-medium">SSL certificate verification is disabled</p> <p class="text-xs text-yellow-700 mt-1">The DISABLE_SSL_VERIFY environment variable is set to true. All outgoing HTTPS connections skip certificate verification.</p></div>'),tt=b('<button class="inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors"><!> Add Elastic Instance</button>'),at=b('<div class="mb-4 bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),rt=b('<div class="bg-white dark:bg-gray-900 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"><h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"> </h3> <!> <div class="space-y-4"><div><label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Instance Name *</label> <input id="name" type="text" placeholder="Production Elastic" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/></div> <div><label for="url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Elastic URL *</label> <input id="url" type="url" placeholder="https://your-elastic.cloud" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Full URL to your Elastic instance</p></div> <div><label for="api-key" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> </label> <input id="api-key" type="password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Create an API key in Kibana: Stack Management → API Keys</p></div> <div class="flex items-center gap-2"><input id="is-active" type="checkbox" class="w-4 h-4 text-primary-600 border-gray-300 dark:border-gray-600 rounded focus:ring-primary-600"/> <label for="is-active" class="text-sm font-medium text-gray-700 dark:text-gray-300">Active</label></div> <div class="flex items-center gap-3 pt-4"><button class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!> Test Connection</button> <button class="inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button> <button class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 transition-colors">Cancel</button></div></div></div>'),st=b('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div></div>'),it=b('<div class="bg-white dark:bg-gray-900 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-12 text-center"><p class="text-gray-500 dark:text-gray-400">No Elastic instances configured yet.</p></div>'),ot=b('<p class="text-xs text-gray-500 dark:text-gray-400"> </p>'),nt=b('<div class="bg-white dark:bg-gray-900 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3 mb-2"><h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100"> </h3> <!></div> <p class="text-sm text-gray-600 dark:text-gray-400 mb-2"> </p> <!></div> <div class="flex items-center gap-2"><span> </span></div></div> <div class="flex items-center gap-2 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"><button class="inline-flex items-center gap-2 px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-sm"><!> Test Connection</button> <button class="inline-flex items-center gap-2 px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-sm"><!> Edit</button> <button class="ml-auto inline-flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm"><!> Delete</button></div></div>'),lt=b('<div class="space-y-4"></div>'),dt=b('<div class="space-y-6"><!> <!> <!> <!></div>');function Ct(he,ke){Ke(ke,!1);let B=p([]),j=p(!1),E=p(!1),H=p(!1),y=p(""),m=p(null),ve=p(!1),L=p(""),x=p(""),_=p(""),D=p(!0);De(async()=>{await q();try{const o=await(await ce(`${S.baseUrl}/api/settings/ssl-status`)).json();a(ve,o.ssl_verification_disabled)}catch{}});async function q(){try{a(E,!0),a(B,await S.collection("elastic_instances").getFullList({sort:"-created"}))}catch(t){a(y,t.message)}finally{a(E,!1)}}function pe(){a(L,""),a(x,""),a(_,""),a(D,!0),a(m,null),a(y,"")}function we(){pe(),a(j,!0)}function Ie(t){a(m,t.id),a(L,t.name),a(x,t.url),a(_,t.api_key),a(D,t.is_active),a(y,""),a(j,!0)}function ge(){a(j,!1),pe()}async function Ce(){var t;try{a(H,!0),a(y,"");const d=await(await ce(`${S.baseUrl}/api/connection/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"elastic",config:{url:e(x),api_key:e(_)}})})).json();d.success?alert(`Connection successful! Found ${((t=d.spaces)==null?void 0:t.length)||0} spaces.`):a(y,d.message)}catch(o){a(y,o.message)}finally{a(H,!1)}}async function Se(){try{a(E,!0),a(y,"");const t={name:e(L),url:e(x),api_key:e(_),is_active:e(D)};e(m)?await S.collection("elastic_instances").update(e(m),t):await S.collection("elastic_instances").create(t),ge(),await q()}catch(t){a(y,t.message)}finally{a(E,!1)}}async function Ee(t){if(confirm("Are you sure you want to delete this instance?"))try{await S.collection("elastic_instances").delete(t),await q()}catch(o){alert(`Error: ${o.message}`)}}async function Ae(t){try{const d=await(await ce(`${S.baseUrl}/api/connection/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"elastic",config:{url:t.url,api_key:t.api_key}})})).json();await S.collection("elastic_instances").update(t.id,{connection_status:d.success?"success":"failed",last_connection_test:new Date().toISOString(),spaces:d.spaces||[]}),await q()}catch(o){console.error("Connection test failed:",o)}}Re();var ee=dt();qe("21ec2",t=>{$e(()=>{Je.title="Elastic Instances - Settings"})});var ye=s(ee);{var Pe=t=>{var o=et();c(t,o)};g(ye,t=>{e(ve)&&t(Pe)})}var ue=n(ye,2);{var Te=t=>{var o=tt(),d=s(o);Ge(d,{class:"w-5 h-5"}),C(),r(o),F("click",o,we),c(t,o)};g(ue,t=>{e(j)||t(Te)})}var be=n(ue,2);{var Fe=t=>{var o=rt(),d=s(o),te=s(d,!0);r(d);var z=n(d,2);{var h=i=>{var v=at(),X=s(v),V=s(X,!0);r(X),r(v),Y(()=>I(V,e(y))),c(i,v)};g(z,i=>{e(y)&&i(h)})}var k=n(z,2),K=s(k),l=n(s(K),2);Z(l),r(K);var A=n(K,2),U=n(s(A),2);Z(U),C(2),r(A);var P=n(A,2),T=s(P),N=s(T);r(T);var $=n(T,2);Z($),C(2),r(P);var J=n(P,2),G=s(J);Z(G),C(2),r(J);var Q=n(J,2),f=s(Q),ae=s(f);{var re=i=>{xe(i,{class:"w-4 h-4 animate-spin"})},se=i=>{_e(i,{class:"w-4 h-4"})};g(ae,i=>{e(H)?i(re):i(se,!1)})}C(),r(f);var w=n(f,2),M=s(w);{var ie=i=>{xe(i,{class:"w-4 h-4 animate-spin"})},W=i=>{var v=Me();Y(()=>I(v,e(m)?"Update":"Save")),c(i,v)};g(M,i=>{e(E)?i(ie):i(W,!1)})}r(w);var O=n(w,2);r(Q),r(k),r(o),Y(()=>{I(te,e(m)?"Edit Elastic Instance":"Add Elastic Instance"),I(N,`API Key ${e(m)?"(leave empty to keep current)":"*"}`),Ve($,"placeholder",e(m)?"••••••••":"Your Elastic API key"),f.disabled=!e(x)||!e(_)||e(H),w.disabled=e(E)||!e(L)||!e(x)||!e(m)&&!e(_)}),de(l,()=>e(L),i=>a(L,i)),de(U,()=>e(x),i=>a(x,i)),de($,()=>e(_),i=>a(_,i)),ze(G,()=>e(D),i=>a(D,i)),F("click",f,Ce),F("click",w,Se),F("click",O,ge),c(t,o)};g(be,t=>{e(j)&&t(Fe)})}var je=n(be,2);{var Le=t=>{var o=st();c(t,o)},Ue=t=>{var o=me(),d=fe(o);{var te=h=>{var k=it();c(h,k)},z=h=>{var k=lt();Ye(k,5,()=>e(B),He,(K,l)=>{var A=nt(),U=s(A),P=s(U),T=s(P),N=s(T),$=s(N,!0);r(N);var J=n(N,2);{var G=u=>{Xe(u,{class:"w-5 h-5 text-green-600"})},Q=u=>{var R=me(),oe=fe(R);{var ne=le=>{Ze(le,{class:"w-5 h-5 text-red-600"})};g(oe,le=>{e(l).connection_status==="failed"&&le(ne)},!0)}c(u,R)};g(J,u=>{e(l).connection_status==="success"?u(G):u(Q,!1)})}r(T);var f=n(T,2),ae=s(f,!0);r(f);var re=n(f,2);{var se=u=>{var R=ot(),oe=s(R);r(R),Y(ne=>I(oe,`Spaces: ${ne??""}`),[()=>e(l).spaces.join(", ")]),c(u,R)};g(re,u=>{e(l).spaces&&e(l).spaces.length>0&&u(se)})}r(P);var w=n(P,2),M=s(w),ie=s(M,!0);r(M),r(w),r(U);var W=n(U,2),O=s(W),i=s(O);_e(i,{class:"w-4 h-4"}),C(),r(O);var v=n(O,2),X=s(v);Qe(X,{class:"w-4 h-4"}),C(),r(v);var V=n(v,2),Oe=s(V);We(Oe,{class:"w-4 h-4"}),C(),r(V),r(W),r(A),Y(()=>{I($,e(l).name),I(ae,e(l).url),Be(M,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
								${e(l).is_active?"bg-green-100 text-green-800":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200"}`),I(ie,e(l).is_active?"Active":"Inactive")}),F("click",O,()=>Ae(e(l))),F("click",v,()=>Ie(e(l))),F("click",V,()=>Ee(e(l).id)),c(K,A)}),r(k),c(h,k)};g(d,h=>{e(B).length===0&&!e(j)?h(te):h(z,!1)},!0)}c(t,o)};g(je,t=>{e(E)&&e(B).length===0?t(Le):t(Ue,!1)})}r(ee),c(he,ee),Ne()}export{Ct as component};

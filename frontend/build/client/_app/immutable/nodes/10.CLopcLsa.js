import"../chunks/CWj6FrbW.js";import{s as g,o as _r}from"../chunks/O7RWNxBF.js";import{c as ee,f as _,a as o,b7 as ur,p as vr,l as G,R as zt,S as fr,s as l,i as e,b as cr,h as r,g as a,r as t,t as C,d as i,U as be,n as V,o as Qe,T as yr,$ as mr,j as nt}from"../chunks/C9NYA0Nw.js";import{i as d}from"../chunks/D2ldot_M.js";import{I as Bt,s as Vt,r as nr,d as br,e as gr,f as hr,a as Dt,i as pr,c as Pt}from"../chunks/z_jCEgha.js";import{h as wr}from"../chunks/k5AYXn5z.js";import{l as It,s as Ht,a as kr,b as Sr}from"../chunks/Cs0PMOxO.js";import{p as jr}from"../chunks/TVtqyaYP.js";import{g as Rr}from"../chunks/DUTeUus3.js";import{a as At,p as me}from"../chunks/BUCyip3L.js";import{b as $r}from"../chunks/DkcqxK1V.js";import"../chunks/Dl2LfGm4.js";import{S as Cr}from"../chunks/BW1vKB3p.js";import{U as Jt}from"../chunks/D8KKMlRR.js";import{L as it}from"../chunks/Bo3rhy3K.js";import{T as Er}from"../chunks/DYGQewJa.js";import{A as Tr}from"../chunks/Di_XImmr.js";import{P as Mr,R as ir}from"../chunks/B3KBZgIT.js";import{T as Nr}from"../chunks/Dr9VXG2L.js";import{D as Pr}from"../chunks/CsmNXNIe.js";import{E as Ut}from"../chunks/c4E_ZoYs.js";import{F as Ar}from"../chunks/CpK8W6VH.js";import{G as or,D as Fr}from"../chunks/TRlj5nHQ.js";import{C as lr}from"../chunks/8LRe_PqV.js";import{T as Lr}from"../chunks/DnyxC-7e.js";import{C as dr}from"../chunks/B0ul5X5D.js";import{R as Gr}from"../chunks/NC3V-jhH.js";import{C as Or}from"../chunks/BF4Or9KR.js";import{G as qr}from"../chunks/DEjX2dQL.js";import{A as Ur}from"../chunks/BsPc02FR.js";import{C as Dr}from"../chunks/D3EV4tGk.js";function Jr(se,h){const D=It(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M10 10.5 8 13l2 2.5"}],["path",{d:"m14 10.5 2 2.5-2 2.5"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2z"}]];Bt(se,Ht({name:"folder-code"},()=>D,{get iconNode(){return M},children:(W,u)=>{var j=ee(),N=_(j);Vt(N,h,"default",{}),o(W,j)},$$slots:{default:!0}}))}function zr(se,h){const D=It(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5"}],["path",{d:"m9 11 3 3L22 4"}]];Bt(se,Ht({name:"square-check-big"},()=>D,{get iconNode(){return M},children:(W,u)=>{var j=ee(),N=_(j);Vt(N,h,"default",{}),o(W,j)},$$slots:{default:!0}}))}function Br(se,h){const D=It(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}]];Bt(se,Ht({name:"square"},()=>D,{get iconNode(){return M},children:(W,u)=>{var j=ee(),N=_(j);Vt(N,h,"default",{}),o(W,j)},$$slots:{default:!0}}))}function Vr(se,h){const D=It(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];Bt(se,Ht({name:"x"},()=>D,{get iconNode(){return M},children:(W,u)=>{var j=ee(),N=_(j);Vt(N,h,"default",{}),o(W,j)},$$slots:{default:!0}}))}var Ir=i("<!> Deselect All",1),Hr=i("<!> Select All",1),Wr=i('<div class="flex items-center justify-center py-12"><!> <span class="ml-2 text-sm text-gray-500 dark:text-gray-400">Loading rules from Elastic...</span></div>'),Qr=i('<div class="flex items-center gap-3 py-8 justify-center"><!> <span class="text-sm text-red-600"> </span></div>'),Xr=i('<div class="text-center py-8 text-sm text-gray-500 dark:text-gray-400"><!></div>'),Kr=i('<span class="w-2 h-2 rounded-full bg-green-500 flex-shrink-0" title="Enabled"></span>'),Yr=i('<span class="w-2 h-2 rounded-full bg-gray-300 flex-shrink-0" title="Disabled"></span>'),Zr=i('<label class="flex items-center gap-3 py-2.5 px-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg cursor-pointer transition-colors border-b border-gray-50 dark:border-gray-800 last:border-0"><input type="checkbox" class="w-4 h-4 rounded border-gray-300 dark:border-gray-600 text-yellow-600 focus:ring-yellow-500"/> <div class="flex-1 min-w-0"><div class="font-medium text-sm text-gray-900 dark:text-gray-100 truncate"> </div> <div class="text-xs text-gray-400 dark:text-gray-500 truncate"> </div></div> <span> </span> <span class="text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-0.5 rounded flex-shrink-0"> </span> <!></label>'),ea=i('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white dark:bg-gray-900 rounded-lg shadow-xl max-w-3xl w-full max-h-[85vh] overflow-hidden flex flex-col"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between flex-shrink-0"><div><h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Select Rules to Export</h2> <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Export to branch: <code class="text-xs bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded"> </code></p></div> <button class="text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"><!></button></div> <div class="px-6 py-3 border-b border-gray-100 dark:border-gray-800 flex items-center gap-3 flex-shrink-0 flex-wrap"><div class="relative flex-1 min-w-[200px]"><!> <input type="text" placeholder="Search rules..." class="w-full pl-9 pr-3 py-2 text-sm border border-gray-200 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"/></div> <select class="text-sm border border-gray-200 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500"><option>All Severities</option><option>Critical</option><option>High</option><option>Medium</option><option>Low</option></select> <button class="inline-flex items-center gap-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 px-3 py-2 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"><!></button></div> <div class="flex-1 overflow-y-auto px-6 py-2 min-h-0"><!></div> <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between flex-shrink-0 bg-gray-50 dark:bg-gray-800"><span class="text-sm text-gray-500 dark:text-gray-400"> </span> <div class="flex items-center gap-3"><button class="px-4 py-2 text-sm text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Cancel</button> <button class="px-4 py-2 text-sm text-yellow-700 border border-yellow-300 rounded-lg hover:bg-yellow-50 transition-colors font-medium"> </button> <button class="inline-flex items-center gap-2 px-4 py-2 text-sm bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed"><!> </button></div></div></div></div>');function ta(se,h){vr(h,!0);let D=G(zt([])),M=G(zt(new Set)),W=G(!1),u=G(""),j=G(""),N=G("all"),oe=be(()=>e(D).filter(f=>{const P=!e(j)||f.name.toLowerCase().includes(e(j).toLowerCase())||f.rule_id.toLowerCase().includes(e(j).toLowerCase()),he=e(N)==="all"||f.severity===e(N);return P&&he})),O=be(()=>e(M).size),ne=be(()=>e(oe).length>0&&e(oe).every(f=>e(M).has(f.rule_id)));fr(()=>{h.open&&Ce()});async function Ce(){l(W,!0),l(u,""),l(j,""),l(N,"all");try{const P=await(await At(`${me.baseUrl}/api/rules/list`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:h.projectId,space:h.space})})).json();P.success?(l(D,P.rules,!0),l(M,new Set(e(D).map(he=>he.rule_id)),!0)):l(u,P.message||"Failed to load rules",!0)}catch(f){l(u,f.message,!0)}finally{l(W,!1)}}function Xe(f){const P=new Set(e(M));P.has(f)?P.delete(f):P.add(f),l(M,P,!0)}function Ke(){if(e(ne)){const f=new Set(e(M));for(const P of e(oe))f.delete(P.rule_id);l(M,f,!0)}else{const f=new Set(e(M));for(const P of e(oe))f.add(P.rule_id);l(M,f,!0)}}function Ye(){h.onexport(Array.from(e(M)))}function lt(){h.onexport(null)}function Ft(f){switch(f){case"critical":return"bg-red-100 text-red-700";case"high":return"bg-orange-100 text-orange-700";case"medium":return"bg-yellow-100 text-yellow-700";case"low":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-600"}}var Q=ee(),E=_(Q);{var J=f=>{var P=ea();P.__keydown=v=>v.key==="Escape"&&h.onclose();var he=r(P);he.__click=v=>v.stopPropagation();var dt=r(he),Ee=r(dt),Ze=a(r(Ee),2),vt=a(r(Ze)),Wt=r(vt,!0);t(vt),t(Ze),t(Ee);var ct=a(Ee,2);ct.__click=function(...v){var c;(c=h.onclose)==null||c.apply(this,v)};var Qt=r(ct);Vr(Qt,{class:"w-5 h-5"}),t(ct),t(dt);var gt=a(dt,2),pt=r(gt),xt=r(pt);Cr(xt,{class:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"});var _t=a(xt,2);nr(_t),t(pt);var qe=a(pt,2),et=r(qe);et.value=et.__value="all";var Ue=a(et);Ue.value=Ue.__value="critical";var De=a(Ue);De.value=De.__value="high";var Je=a(De);Je.value=Je.__value="medium";var tt=a(Je);tt.value=tt.__value="low",t(qe);var ut=a(qe,2);ut.__click=Ke;var Xt=r(ut);{var Kt=v=>{var c=Ir(),A=_(c);zr(A,{class:"w-4 h-4"}),V(),o(v,c)},Yt=v=>{var c=Hr(),A=_(c);Br(A,{class:"w-4 h-4"}),V(),o(v,c)};d(Xt,v=>{e(ne)?v(Kt):v(Yt,!1)})}t(ut),t(gt);var ft=a(gt,2),Zt=r(ft);{var Lt=v=>{var c=Wr(),A=r(c);it(A,{class:"w-6 h-6 animate-spin text-yellow-600"}),V(2),t(c),o(v,c)},er=v=>{var c=ee(),A=_(c);{var xe=ie=>{var te=Qr(),we=r(te);Er(we,{class:"w-5 h-5 text-red-500"});var Me=a(we,2),ke=r(Me,!0);t(Me),t(te),C(()=>g(ke,e(u))),o(ie,te)},Te=ie=>{var te=ee(),we=_(te);{var Me=X=>{var K=Xr(),ze=r(K);{var bt=I=>{var _e=Qe("No rules match your filter.");o(I,_e)},re=I=>{var _e=Qe("No rules found in Elastic.");o(I,_e)};d(ze,I=>{e(j)||e(N)!=="all"?I(bt):I(re,!1)})}t(K),o(X,K)},ke=X=>{var K=ee(),ze=_(K);gr(ze,17,()=>e(oe),pr,(bt,re)=>{var I=Zr(),_e=r(I);nr(_e),_e.__change=()=>Xe(e(re).rule_id);var ht=a(_e,2),wt=r(ht),qt=r(wt,!0);t(wt);var at=a(wt,2),kt=r(at,!0);t(at),t(ht);var st=a(ht,2),ar=r(st,!0);t(st);var St=a(st,2),sr=r(St,!0);t(St);var b=a(St,2);{var p=y=>{var R=Kr();o(y,R)},w=y=>{var R=Yr();o(y,R)};d(b,y=>{e(re).enabled?y(p):y(w,!1)})}t(I),C((y,R)=>{hr(_e,y),g(qt,e(re).name),g(kt,e(re).rule_id),Dt(st,1,`text-xs px-2 py-0.5 rounded font-medium flex-shrink-0 ${R??""}`),g(ar,e(re).severity),g(sr,e(re).type)},[()=>e(M).has(e(re).rule_id),()=>Ft(e(re).severity)]),o(bt,I)}),o(X,K)};d(we,X=>{e(oe).length===0?X(Me):X(ke,!1)},!0)}o(ie,te)};d(A,ie=>{e(u)?ie(xe):ie(Te,!1)},!0)}o(v,c)};d(Zt,v=>{e(W)?v(Lt):v(er,!1)})}t(ft);var yt=a(ft,2),mt=r(yt),tr=r(mt);t(mt);var Gt=a(mt,2),Ot=r(Gt);Ot.__click=function(...v){var c;(c=h.onclose)==null||c.apply(this,v)};var rt=a(Ot,2);rt.__click=lt;var rr=r(rt);t(rt);var s=a(rt,2);s.__click=Ye;var n=r(s);Jt(n,{class:"w-4 h-4"});var T=a(n);t(s),t(Gt),t(yt),t(he),t(P),C(()=>{g(Wt,h.branch),g(tr,`${e(O)??""} of ${e(D).length??""} rules selected`),g(rr,`Export All (${e(D).length??""})`),s.disabled=e(O)===0,g(T,` Export Selected (${e(O)??""})`)}),$r(_t,()=>e(j),v=>l(j,v)),br(qe,()=>e(N),v=>l(N,v)),o(f,P)};d(E,f=>{h.open&&f(J)})}o(se,Q),cr()}ur(["keydown","click","change"]);var ra=i('<h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">Loading...</h1>'),aa=i('<p class="mt-1 text-sm text-gray-500 dark:text-gray-400"> </p>'),sa=i('<div class="flex items-center gap-3"><h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100"> </h1> <span> </span></div> <!>',1),oa=i('<div class="flex items-center gap-2"><a class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"><!> Edit</a> <button class="inline-flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg transition-colors"><!></button></div>'),na=i('<div class="alert bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"><p class="text-sm text-red-800 dark:text-red-200"> </p></div>'),ia=i('<div class="alert bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"><p class="text-sm text-green-800 dark:text-green-200"> </p></div>'),la=i('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div></div>'),da=i('<a target="_blank" class="inline-flex items-center gap-2 px-3 py-1.5 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 rounded-lg text-sm hover:bg-orange-100 dark:hover:bg-orange-900/30 transition-colors"><!> <span class="font-medium"> </span> <!></a>'),va=i('<a target="_blank" class="inline-flex items-center gap-2 px-3 py-1.5 bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-400 rounded-lg text-sm hover:bg-purple-100 dark:hover:bg-purple-900/30 transition-colors"><!> <span class="font-medium"> </span> <!></a> <a target="_blank" class="inline-flex items-center gap-2 px-3 py-1.5 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400 rounded-lg text-sm hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors"><!> <span class="font-medium">Merge Requests</span> <!></a>',1),ca=i('<div class="hidden sm:block w-px h-5 bg-gray-200 dark:bg-gray-700"></div> <div class="inline-flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400"><!> </div>',1),ga=i('<p class="text-xs text-gray-500 dark:text-gray-400"> </p>'),pa=i("<!> Syncing...",1),xa=i("<!> Export to Git",1),_a=i('<div class="space-y-4"><div class="flex items-center gap-4 text-sm"><div class="flex items-center gap-2"><span class="text-gray-500 dark:text-gray-400">Rules:</span> <span class="font-semibold text-gray-900 dark:text-gray-100"> </span></div> <div class="flex items-center gap-2"><span class="text-gray-500 dark:text-gray-400">Branch:</span> <span class="font-mono text-xs bg-gray-100 dark:bg-gray-800 px-2 py-0.5 rounded"> </span></div></div> <button class="btn w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 hover:shadow-md transition-all disabled:opacity-50 text-sm font-medium"><!></button></div>'),ua=i('<p class="text-sm text-yellow-700 dark:text-yellow-400">No environment configured</p>'),fa=i('<div class="max-w-md"><div class="bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-800/50 rounded-xl p-5"><div class="flex items-center gap-3 mb-4"><div class="p-2.5 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg"><!></div> <div><h3 class="font-semibold text-gray-900 dark:text-gray-100">Export to Git</h3> <!></div></div> <!></div></div>'),ya=i('<p class="text-xs text-gray-500 dark:text-gray-400 truncate"> </p>'),ma=i("<!> Syncing...",1),ba=i("<!> Export",1),ha=i('<div class="space-y-3"><div class="flex items-center justify-between text-sm"><span class="text-gray-500 dark:text-gray-400">Rules</span> <span class="font-semibold text-gray-900 dark:text-gray-100"> </span></div> <div class="flex items-center justify-between text-sm"><span class="text-gray-500 dark:text-gray-400">Branch</span> <span class="font-mono text-xs bg-white dark:bg-gray-800 border border-yellow-200 dark:border-yellow-800/50 px-2 py-0.5 rounded"> </span></div> <button class="btn w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 hover:shadow-md transition-all disabled:opacity-50 text-sm font-medium"><!></button></div>'),wa=i('<p class="text-sm text-yellow-700 dark:text-yellow-400">Not configured</p>'),ka=i("<!> Creating...",1),Sa=i("<!> Create MR",1),ja=i('<a target="_blank" class="block text-center text-xs text-blue-600 dark:text-blue-400 hover:underline">View open MRs <!></a>'),Ra=i('<div class="space-y-3"><div class="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"><!> <span class="font-mono text-xs truncate"> </span> <!> <span class="font-mono text-xs truncate"> </span></div> <button class="btn w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:shadow-md transition-all disabled:opacity-50 text-sm font-medium"><!></button> <!></div>'),$a=i('<p class="text-sm text-blue-700 dark:text-blue-400">Configure both environments</p>'),Ca=i('<p class="text-xs text-gray-500 dark:text-gray-400 truncate"> </p>'),Ea=i("<!> Syncing...",1),Ta=i("<!> Import",1),Ma=i('<div class="space-y-3"><div class="flex items-center justify-between text-sm"><span class="text-gray-500 dark:text-gray-400">Rules</span> <span class="font-semibold text-gray-900 dark:text-gray-100"> </span></div> <div class="flex items-center justify-between text-sm"><span class="text-gray-500 dark:text-gray-400">Branch</span> <span class="font-mono text-xs bg-white dark:bg-gray-800 border border-green-200 dark:border-green-800/50 px-2 py-0.5 rounded"> </span></div> <button class="btn w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 hover:shadow-md transition-all disabled:opacity-50 text-sm font-medium"><!></button></div>'),Na=i('<p class="text-sm text-green-700 dark:text-green-400">Not configured</p>'),Pa=i('<div class="flex items-start gap-3"><div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-3"><span class="flex-shrink-0 w-6 h-6 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 rounded-full flex items-center justify-center text-xs font-bold">1</span> <div class="flex-1 h-px bg-gray-200 dark:bg-gray-700"></div></div> <div class="bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-800/50 rounded-xl p-4"><div class="flex items-center gap-2 mb-3"><div class="p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg"><!></div> <div class="min-w-0"><h3 class="font-semibold text-sm text-gray-900 dark:text-gray-100">Export to Git</h3> <!></div></div> <!></div></div> <div class="flex items-center pt-10 flex-shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-3"><span class="flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded-full flex items-center justify-center text-xs font-bold">2</span> <div class="flex-1 h-px bg-gray-200 dark:bg-gray-700"></div></div> <div class="bg-blue-50 dark:bg-blue-900/10 border border-blue-200 dark:border-blue-800/50 rounded-xl p-4"><div class="flex items-center gap-2 mb-3"><div class="p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg"><!></div> <div class="min-w-0"><h3 class="font-semibold text-sm text-gray-900 dark:text-gray-100">Merge Request</h3> <p class="text-xs text-gray-500 dark:text-gray-400">Review & Approve</p></div></div> <!></div></div> <div class="flex items-center pt-10 flex-shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-3"><span class="flex-shrink-0 w-6 h-6 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full flex items-center justify-center text-xs font-bold">3</span> <div class="flex-1 h-px bg-transparent"></div></div> <div class="bg-green-50 dark:bg-green-900/10 border border-green-200 dark:border-green-800/50 rounded-xl p-4"><div class="flex items-center gap-2 mb-3"><div class="p-2 bg-green-100 dark:bg-green-900/30 rounded-lg"><!></div> <div class="min-w-0"><h3 class="font-semibold text-sm text-gray-900 dark:text-gray-100">Production</h3> <!></div></div> <!></div></div></div>'),Aa=i('<div class="px-6 py-10 text-center"><!> <p class="text-sm text-gray-500 dark:text-gray-400">No sync jobs yet.</p> <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">Start by exporting rules from your environment.</p></div>'),Fa=i('<p class="text-xs text-gray-500 dark:text-gray-400 mt-0.5"> <!> <!></p>'),La=i('<div class="flex items-center justify-between px-6 py-3 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors"><div class="flex items-center gap-3 min-w-0"><div><!></div> <div class="min-w-0"><div class="flex items-center gap-2"><span class="text-sm font-medium text-gray-900 dark:text-gray-100"><!></span> <span> </span></div> <!></div></div> <div class="text-xs text-gray-500 dark:text-gray-400 flex-shrink-0 ml-4"> </div></div>'),Ga=i('<div class="px-6 py-3 border-t border-gray-100 dark:border-gray-800"><a href="/history" class="text-xs font-medium text-primary-600 hover:text-primary-700">View all sync history →</a></div>'),Oa=i('<div class="divide-y divide-gray-100 dark:divide-gray-800"></div> <!>',1),qa=i('<div class="card animate-fade-in" style="animation-delay: 50ms; opacity: 0;"><div class="flex items-center gap-4 px-6 py-3 flex-wrap"><!> <!> <div class="hidden sm:block w-px h-5 bg-gray-200 dark:bg-gray-700"></div> <div class="inline-flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400"><!> <span class="font-mono"> </span></div> <!></div></div> <div class="card p-6 animate-fade-in" style="animation-delay: 100ms; opacity: 0;"><h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6">Sync Workflow</h2> <!></div> <div class="card animate-fade-in" style="animation-delay: 200ms; opacity: 0;"><div class="flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Recent Syncs</h2> <button class="p-1.5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors"><!></button></div> <!></div>',1),Ua=i('<div class="space-y-6"><div class="flex items-center justify-between animate-fade-in"><div><a href="/projects" class="inline-flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 mb-2 transition-colors duration-200"><!> Back to Projects</a> <!></div> <!></div> <!> <!> <!></div> <!>',1);function ys(se,h){vr(h,!0);const D=()=>Sr(jr,"$page",M),[M,W]=kr();let u=G(null),j=G(zt([])),N=G(zt([])),oe=G(!0),O=G(""),ne=G(""),Ce=G(!1),Xe=G(!1),Ke=G(!1),Ye=G(!1),lt=G(0),Ft=G(0),Q=be(()=>D().params.id),E=be(()=>e(j).find(s=>s.name==="test")),J=be(()=>e(j).find(s=>s.name==="production")),f=be(()=>{var s;return((s=e(u))==null?void 0:s.sync_mode)==="export_only"});_r(async()=>{await P()});async function P(){try{l(oe,!0),await Promise.all([he(),dt(),Ee(),Ze()])}finally{l(oe,!1)}}async function he(){try{l(u,await me.collection("projects").getOne(e(Q),{expand:"elastic_instance,git_repository"}),!0)}catch(s){l(O,s.message,!0)}}async function dt(){try{l(j,await me.collection("environments").getFullList({filter:`project = "${e(Q)}"`}),!0)}catch(s){console.error("Failed to load environments:",s)}}async function Ee(){try{const s=await me.collection("sync_jobs").getList(1,10,{filter:`project = "${e(Q)}"`,sort:"-created"});l(N,s.items,!0)}catch(s){console.error("Failed to load sync jobs:",s)}}async function Ze(){try{const s=await At(`${me.baseUrl}/api/project/${e(Q)}/metrics`);if(s.ok){const n=await s.json();l(lt,n.test_rules||0,!0),l(Ft,n.prod_rules||0,!0)}}catch(s){console.error("Failed to load metrics:",s)}}function vt(){l(Ye,!0)}async function Wt(s){if(l(Ye,!1),!!e(E))try{l(Ce,!0),l(O,""),l(ne,"");const n={project_id:e(Q),environment_id:e(E).id,direction:"elastic_to_git",branch:e(E).git_branch,space:e(E).elastic_space};s!==null&&(n.rule_ids=s);const v=await(await At(`${me.baseUrl}/api/sync/trigger`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();v.success?(l(ne,v.message,!0),await Ee(),await Ze()):l(O,v.message||"Failed to sync",!0)}catch(n){l(O,n.message,!0)}finally{l(Ce,!1)}}async function ct(){if(!(!e(E)||!e(J)))try{l(Ke,!0),l(O,""),l(ne,"");const n=await(await At(`${me.baseUrl}/api/merge-request/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:e(Q),source_branch:e(E).git_branch,target_branch:e(J).git_branch,title:`[Elastic Git Sync] Promote rules from ${e(E).elastic_space} to ${e(J).elastic_space}`})})).json();if(n.success&&n.url){let T="Merge Request created!";n.conflicts_resolved&&(T+=` (${n.conflicts_count||"all"} conflicts auto-resolved)`),T+=" Opening in new tab...",l(ne,T,!0),window.open(n.url,"_blank")}else l(O,n.message||"Failed to create Merge Request",!0)}catch(s){l(O,s.message,!0)}finally{l(Ke,!1)}}async function Qt(){if(e(J))try{l(Xe,!0),l(O,""),l(ne,"");const n=await(await At(`${me.baseUrl}/api/sync/trigger`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:e(Q),environment_id:e(J).id,direction:"git_to_elastic",branch:e(J).git_branch,space:e(J).elastic_space})})).json();n.success?(l(ne,n.message,!0),await Ee(),await Ze()):l(O,n.message||"Failed to sync",!0)}catch(s){l(O,s.message,!0)}finally{l(Xe,!1)}}async function gt(){if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{for(const s of e(j))await me.collection("environments").delete(s.id);await me.collection("projects").delete(e(Q)),Rr("/projects")}catch(s){l(O,s.message,!0)}}function pt(s){switch(s){case"completed":return"text-green-600";case"failed":return"text-red-600";case"running":return"text-blue-600";default:return"text-gray-600 dark:text-gray-400"}}function xt(s){switch(s){case"completed":return"bg-green-100";case"failed":return"bg-red-100";case"running":return"bg-blue-100";default:return"bg-gray-100 dark:bg-gray-800"}}function _t(s){if(!s)return"Never";const n=new Date(s),v=new Date().getTime()-n.getTime(),c=Math.floor(v/6e4);if(c<1)return"Just now";if(c<60)return`${c}m ago`;const A=Math.floor(c/60);return A<24?`${A}h ago`:`${Math.floor(A/24)}d ago`}function qe(s){return(s==null?void 0:s.replace(/\.git$/,""))||""}var et=Ua();wr("ffmenf",s=>{yr(()=>{var n;mr.title=`${(((n=e(u))==null?void 0:n.name)||"Project")??""} - Elastic Git Sync`})});var Ue=_(et),De=r(Ue),Je=r(De),tt=r(Je),ut=r(tt);Tr(ut,{class:"w-4 h-4 transition-transform duration-200 hover:-translate-x-1"}),V(),t(tt);var Xt=a(tt,2);{var Kt=s=>{var n=ra();o(s,n)},Yt=s=>{var n=ee(),T=_(n);{var v=c=>{var A=sa(),xe=_(A),Te=r(xe),ie=r(Te,!0);t(Te);var te=a(Te,2),we=r(te,!0);t(te),t(xe);var Me=a(xe,2);{var ke=X=>{var K=aa(),ze=r(K,!0);t(K),C(()=>g(ze,e(u).description)),o(X,K)};d(Me,X=>{e(u).description&&X(ke)})}C(()=>{g(ie,e(u).name),Dt(te,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e(f)?"bg-yellow-100 text-yellow-700":"bg-primary-100 text-primary-700"}`),g(we,e(f)?"Export Only":"Full Workflow")}),o(c,A)};d(T,c=>{e(u)&&c(v)},!0)}o(s,n)};d(Xt,s=>{e(oe)?s(Kt):s(Yt,!1)})}t(Je);var ft=a(Je,2);{var Zt=s=>{var n=oa(),T=r(n),v=r(T);Mr(v,{class:"w-4 h-4"}),V(),t(T);var c=a(T,2),A=r(c);Nr(A,{class:"w-4 h-4"}),t(c),t(n),C(()=>Pt(T,"href",`/projects/${e(Q)??""}/edit`)),nt("click",c,gt),o(s,n)};d(ft,s=>{e(u)&&s(Zt)})}t(De);var Lt=a(De,2);{var er=s=>{var n=na(),T=r(n),v=r(T,!0);t(T),t(n),C(()=>g(v,e(O))),o(s,n)};d(Lt,s=>{e(O)&&s(er)})}var yt=a(Lt,2);{var mt=s=>{var n=ia(),T=r(n),v=r(T,!0);t(T),t(n),C(()=>g(v,e(ne))),o(s,n)};d(yt,s=>{e(ne)&&s(mt)})}var tr=a(yt,2);{var Gt=s=>{var n=la();o(s,n)},Ot=s=>{var n=ee(),T=_(n);{var v=c=>{var A=qa(),xe=_(A),Te=r(xe),ie=r(Te);{var te=b=>{const p=be(()=>e(u).expand.elastic_instance.url);var w=da(),y=r(w);Pr(y,{class:"w-3.5 h-3.5"});var R=a(y,2),F=r(R,!0);t(R);var k=a(R,2);Ut(k,{class:"w-3 h-3 opacity-50"}),t(w),C(()=>{Pt(w,"href",`${e(p)??""}/app/security/rules`),g(F,e(u).expand.elastic_instance.name)}),o(b,w)};d(ie,b=>{var p;(p=e(u).expand)!=null&&p.elastic_instance&&b(te)})}var we=a(ie,2);{var Me=b=>{const p=be(()=>qe(e(u).expand.git_repository.url));var w=va(),y=_(w),R=r(y);Ar(R,{class:"w-3.5 h-3.5"});var F=a(R,2),k=r(F,!0);t(F);var ue=a(F,2);Ut(ue,{class:"w-3 h-3 opacity-50"}),t(y);var le=a(y,2),de=r(le);or(de,{class:"w-3.5 h-3.5"});var Be=a(de,4);Ut(Be,{class:"w-3 h-3 opacity-50"}),t(le),C(()=>{Pt(y,"href",e(p)),g(k,e(u).expand.git_repository.name),Pt(le,"href",`${e(p)??""}/-/merge_requests`)}),o(b,w)};d(we,b=>{var p;(p=e(u).expand)!=null&&p.git_repository&&b(Me)})}var ke=a(we,4),X=r(ke);Jr(X,{class:"w-3.5 h-3.5"});var K=a(X,2),ze=r(K,!0);t(K),t(ke);var bt=a(ke,2);{var re=b=>{var p=ca(),w=a(_(p),2),y=r(w);lr(y,{class:"w-3.5 h-3.5"});var R=a(y);t(w),C(F=>g(R,` Last sync ${F??""}`),[()=>_t(e(N)[0].created)]),o(b,p)};d(bt,b=>{e(N).length>0&&b(re)})}t(Te),t(xe);var I=a(xe,2),_e=a(r(I),2);{var ht=b=>{var p=fa(),w=r(p),y=r(w),R=r(y),F=r(R);Jt(F,{class:"w-5 h-5 text-yellow-600"}),t(R);var k=a(R,2),ue=a(r(k),2);{var le=H=>{var U=ga(),ve=r(U);t(U),C(()=>g(ve,`${e(E).elastic_space??""} → ${e(E).git_branch??""}`)),o(H,U)};d(ue,H=>{e(E)&&H(le)})}t(k),t(y);var de=a(y,2);{var Be=H=>{var U=_a(),ve=r(U),ce=r(ve),Ve=a(r(ce),2),Ie=r(Ve,!0);t(Ve),t(ce);var He=a(ce,2),Ne=a(r(He),2),Rt=r(Ne,!0);t(Ne),t(He),t(ve);var Pe=a(ve,2),$t=r(Pe);{var Ae=x=>{var $=pa(),q=_($);it(q,{class:"w-4 h-4 animate-spin"}),V(),o(x,$)},Ct=x=>{var $=xa(),q=_($);Jt(q,{class:"w-4 h-4"}),V(),o(x,$)};d($t,x=>{e(Ce)?x(Ae):x(Ct,!1)})}t(Pe),t(U),C(()=>{g(Ie,e(lt)),g(Rt,e(E).git_branch),Pe.disabled=e(Ce)}),nt("click",Pe,vt),o(H,U)},jt=H=>{var U=ua();o(H,U)};d(de,H=>{e(E)?H(Be):H(jt,!1)})}t(w),t(p),o(b,p)},wt=b=>{var p=Pa(),w=r(p),y=a(r(w),2),R=r(y),F=r(R),k=r(F);Lr(k,{class:"w-4 h-4 text-yellow-600"}),t(F);var ue=a(F,2),le=a(r(ue),2);{var de=m=>{var S=ya(),z=r(S,!0);t(S),C(()=>g(z,e(E).elastic_space)),o(m,S)};d(le,m=>{e(E)&&m(de)})}t(ue),t(R);var Be=a(R,2);{var jt=m=>{var S=ha(),z=r(S),Ge=a(r(z),2),We=r(Ge,!0);t(Ge),t(z);var je=a(z,2),Oe=a(r(je),2),ot=r(Oe,!0);t(Oe),t(je);var pe=a(je,2),Re=r(pe);{var Tt=B=>{var Y=ma(),$e=_(Y);it($e,{class:"w-4 h-4 animate-spin"}),V(),o(B,Y)},Mt=B=>{var Y=ba(),$e=_(Y);Jt($e,{class:"w-4 h-4"}),V(),o(B,Y)};d(Re,B=>{e(Ce)?B(Tt):B(Mt,!1)})}t(pe),t(S),C(()=>{g(We,e(lt)),g(ot,e(E).git_branch),pe.disabled=e(Ce)}),nt("click",pe,vt),o(m,S)},H=m=>{var S=wa();o(m,S)};d(Be,m=>{e(E)?m(jt):m(H,!1)})}t(y),t(w);var U=a(w,2),ve=r(U);dr(ve,{class:"w-6 h-6 text-gray-300 dark:text-gray-600"}),t(U);var ce=a(U,2),Ve=a(r(ce),2),Ie=r(Ve),He=r(Ie),Ne=r(He);or(Ne,{class:"w-4 h-4 text-blue-600"}),t(He),V(2),t(Ie);var Rt=a(Ie,2);{var Pe=m=>{var S=Ra(),z=r(S),Ge=r(z);qr(Ge,{class:"w-3.5 h-3.5 flex-shrink-0"});var We=a(Ge,2),je=r(We,!0);t(We);var Oe=a(We,2);Ur(Oe,{class:"w-3.5 h-3.5 flex-shrink-0 text-gray-400 dark:text-gray-500"});var ot=a(Oe,2),pe=r(ot,!0);t(ot),t(z);var Re=a(z,2),Tt=r(Re);{var Mt=ye=>{var Z=ka(),Nt=_(Z);it(Nt,{class:"w-4 h-4 animate-spin"}),V(),o(ye,Z)},B=ye=>{var Z=Sa(),Nt=_(Z);or(Nt,{class:"w-4 h-4"}),V(),o(ye,Z)};d(Tt,ye=>{e(Ke)?ye(Mt):ye(B,!1)})}t(Re);var Y=a(Re,2);{var $e=ye=>{var Z=ja(),Nt=a(r(Z));Ut(Nt,{class:"w-3 h-3 inline"}),t(Z),C(xr=>Pt(Z,"href",`${xr??""}/-/merge_requests`),[()=>qe(e(u).expand.git_repository.url)]),o(ye,Z)};d(Y,ye=>{var Z;(Z=e(u).expand)!=null&&Z.git_repository&&ye($e)})}t(S),C(()=>{g(je,e(E).git_branch),g(pe,e(J).git_branch),Re.disabled=e(Ke)}),nt("click",Re,ct),o(m,S)},$t=m=>{var S=$a();o(m,S)};d(Rt,m=>{e(E)&&e(J)?m(Pe):m($t,!1)})}t(Ve),t(ce);var Ae=a(ce,2),Ct=r(Ae);dr(Ct,{class:"w-6 h-6 text-gray-300 dark:text-gray-600"}),t(Ae);var x=a(Ae,2),$=a(r(x),2),q=r($),ae=r(q),Fe=r(ae);Gr(Fe,{class:"w-4 h-4 text-green-600"}),t(ae);var L=a(ae,2),fe=a(r(L),2);{var Et=m=>{var S=Ca(),z=r(S,!0);t(S),C(()=>g(z,e(J).elastic_space)),o(m,S)};d(fe,m=>{e(J)&&m(Et)})}t(L),t(q);var ge=a(q,2);{var Se=m=>{var S=Ma(),z=r(S),Ge=a(r(z),2),We=r(Ge,!0);t(Ge),t(z);var je=a(z,2),Oe=a(r(je),2),ot=r(Oe,!0);t(Oe),t(je);var pe=a(je,2),Re=r(pe);{var Tt=B=>{var Y=Ea(),$e=_(Y);it($e,{class:"w-4 h-4 animate-spin"}),V(),o(B,Y)},Mt=B=>{var Y=Ta(),$e=_(Y);Fr($e,{class:"w-4 h-4"}),V(),o(B,Y)};d(Re,B=>{e(Xe)?B(Tt):B(Mt,!1)})}t(pe),t(S),C(()=>{g(We,e(Ft)),g(ot,e(J).git_branch),pe.disabled=e(Xe)}),nt("click",pe,Qt),o(m,S)},Le=m=>{var S=Na();o(m,S)};d(ge,m=>{e(J)?m(Se):m(Le,!1)})}t($),t(x),t(p),o(b,p)};d(_e,b=>{e(f)?b(ht):b(wt,!1)})}t(I);var qt=a(I,2),at=r(qt),kt=a(r(at),2),st=r(kt);ir(st,{class:"w-4 h-4"}),t(kt),t(at);var ar=a(at,2);{var St=b=>{var p=Aa(),w=r(p);ir(w,{class:"w-8 h-8 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),V(4),t(p),o(b,p)},sr=b=>{var p=Oa(),w=_(p);gr(w,21,()=>e(N).slice(0,8),pr,(F,k)=>{var ue=La(),le=r(ue),de=r(le),Be=r(de);{var jt=x=>{Or(x,{class:"w-4 h-4 text-green-600"})},H=x=>{var $=ee(),q=_($);{var ae=L=>{Dr(L,{class:"w-4 h-4 text-red-600"})},Fe=L=>{var fe=ee(),Et=_(fe);{var ge=Le=>{it(Le,{class:"w-4 h-4 text-blue-600 animate-spin"})},Se=Le=>{lr(Le,{class:"w-4 h-4 text-yellow-600"})};d(Et,Le=>{e(k).status==="running"?Le(ge):Le(Se,!1)},!0)}o(L,fe)};d(q,L=>{e(k).status==="failed"?L(ae):L(Fe,!1)},!0)}o(x,$)};d(Be,x=>{e(k).status==="completed"?x(jt):x(H,!1)})}t(de);var U=a(de,2),ve=r(U),ce=r(ve),Ve=r(ce);{var Ie=x=>{var $=Qe("Export to Git");o(x,$)},He=x=>{var $=ee(),q=_($);{var ae=L=>{var fe=Qe("Import from Git");o(L,fe)},Fe=L=>{var fe=Qe("Bidirectional");o(L,fe)};d(q,L=>{e(k).direction==="git_to_elastic"?L(ae):L(Fe,!1)},!0)}o(x,$)};d(Ve,x=>{e(k).direction==="elastic_to_git"?x(Ie):x(He,!1)})}t(ce);var Ne=a(ce,2),Rt=r(Ne,!0);t(Ne),t(ve);var Pe=a(ve,2);{var $t=x=>{const $=be(()=>typeof e(k).changes_summary=="string"?JSON.parse(e(k).changes_summary):e(k).changes_summary);var q=Fa(),ae=r(q),Fe=a(ae);{var L=ge=>{var Se=Qe();C(()=>g(Se,`, ${e($).deleted??""} deleted`)),o(ge,Se)};d(Fe,ge=>{e($).deleted&&ge(L)})}var fe=a(Fe,2);{var Et=ge=>{var Se=Qe();C(()=>g(Se,`, ${e($).imported??""} imported`)),o(ge,Se)};d(fe,ge=>{e($).imported&&ge(Et)})}t(q),C(()=>g(ae,`${(e($).exported||0)??""} exported `)),o(x,q)};d(Pe,x=>{e(k).changes_summary&&x($t)})}t(U),t(le);var Ae=a(le,2),Ct=r(Ae,!0);t(Ae),t(ue),C((x,$,q,ae)=>{Dt(de,1,`p-1.5 rounded-lg ${x??""}`),Dt(Ne,1,`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${$??""} ${q??""}`),g(Rt,e(k).status),g(Ct,ae)},[()=>xt(e(k).status),()=>xt(e(k).status),()=>pt(e(k).status),()=>_t(e(k).created)]),o(F,ue)}),t(w);var y=a(w,2);{var R=F=>{var k=Ga();o(F,k)};d(y,F=>{e(N).length>8&&F(R)})}o(b,p)};d(ar,b=>{e(N).length===0?b(St):b(sr,!1)})}t(qt),C(()=>g(ze,e(u).git_path||"/")),nt("click",kt,Ee),o(c,A)};d(T,c=>{e(u)&&c(v)},!0)}o(s,n)};d(tr,s=>{e(oe)?s(Gt):s(Ot,!1)})}t(Ue);var rt=a(Ue,2);{var rr=s=>{ta(s,{get open(){return e(Ye)},get projectId(){return e(Q)},get space(){return e(E).elastic_space},get branch(){return e(E).git_branch},onexport:Wt,onclose:()=>l(Ye,!1)})};d(rt,s=>{e(E)&&s(rr)})}o(se,et),cr(),W()}export{ys as component};

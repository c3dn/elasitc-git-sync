import"../chunks/CWj6FrbW.js";import{i as Te}from"../chunks/DBRSZtkI.js";import{o as Le,s as C}from"../chunks/CdzGu8ER.js";import{p as Oe,a as d,b as Ue,e as Ke,d as y,s as a,$ as Ne,g as s,h as e,i as n,r,m,n as I,j,t as q,c as me,f as fe,k as Re}from"../chunks/CbRa-Z4u.js";import{i as f}from"../chunks/CoDRCLiZ.js";import{r as Z,a as De,e as Je,b as Me,i as $e}from"../chunks/DZIrD1K_.js";import{h as Ye}from"../chunks/Bj3l4WMm.js";import{b as ce,a as qe}from"../chunks/Bd-nUEkM.js";import{p as F}from"../chunks/VVSrSIoj.js";import{P as ze}from"../chunks/CYWbWdYt.js";import{L as ge}from"../chunks/B04TN2pU.js";import{R as be,P as Be}from"../chunks/B0Xgqp6E.js";import{T as Ge}from"../chunks/IMcaUzhR.js";import{C as He}from"../chunks/CmruH-jB.js";import{C as Qe}from"../chunks/BVRwiDW0.js";var Ve=y('<button class="inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors"><!> Add Elastic Instance</button>'),We=y('<div class="mb-4 bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),Xe=y('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4"> </h3> <!> <div class="space-y-4"><div><label for="name" class="block text-sm font-medium text-gray-700 mb-2">Instance Name *</label> <input id="name" type="text" placeholder="Production Elastic" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/></div> <div><label for="url" class="block text-sm font-medium text-gray-700 mb-2">Elastic URL *</label> <input id="url" type="url" placeholder="https://your-elastic.cloud" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Full URL to your Elastic instance</p></div> <div><label for="api-key" class="block text-sm font-medium text-gray-700 mb-2"> </label> <input id="api-key" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-600 focus:border-transparent"/> <p class="text-xs text-gray-500 mt-1">Create an API key in Kibana: Stack Management → API Keys</p></div> <div class="flex items-center gap-2"><input id="is-active" type="checkbox" class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-600"/> <label for="is-active" class="text-sm font-medium text-gray-700">Active</label></div> <div class="flex items-center gap-3 pt-4"><button class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!> Test Connection</button> <button class="inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button> <button class="px-4 py-2 text-gray-700 hover:text-gray-900 transition-colors">Cancel</button></div></div></div>'),Ze=y('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div></div>'),et=y('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"><p class="text-gray-500">No Elastic instances configured yet.</p></div>'),tt=y('<p class="text-xs text-gray-500"> </p>'),at=y('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3 mb-2"><h3 class="text-lg font-semibold text-gray-900"> </h3> <!></div> <p class="text-sm text-gray-600 mb-2"> </p> <!></div> <div class="flex items-center gap-2"><span> </span></div></div> <div class="flex items-center gap-2 mt-4 pt-4 border-t border-gray-200"><button class="inline-flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm"><!> Test Connection</button> <button class="inline-flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm"><!> Edit</button> <button class="ml-auto inline-flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm"><!> Delete</button></div></div>'),rt=y('<div class="space-y-4"></div>'),st=y('<div class="space-y-6"><!> <!> <!></div>');function xt(ye,_e){Oe(_e,!1);let z=m([]),T=m(!1),E=m(!1),B=m(!1),p=m(""),g=m(null),L=m(""),_=m(""),x=m(""),N=m(!0);Le(async()=>{await G()});async function G(){try{a(E,!0),a(z,await F.collection("elastic_instances").getFullList({sort:"-created"}))}catch(t){a(p,t.message)}finally{a(E,!1)}}function de(){a(L,""),a(_,""),a(x,""),a(N,!0),a(g,null),a(p,"")}function xe(){de(),a(T,!0)}function he(t){a(g,t.id),a(L,t.name),a(_,t.url),a(x,t.api_key),a(N,t.is_active),a(p,""),a(T,!0)}function ve(){a(T,!1),de()}async function we(){var t;try{a(B,!0),a(p,"");const c=await(await fetch(`${F.baseUrl}/api/connection/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"elastic",config:{url:e(_),api_key:e(x)}})})).json();c.success?alert(`Connection successful! Found ${((t=c.spaces)==null?void 0:t.length)||0} spaces.`):a(p,c.message)}catch(o){a(p,o.message)}finally{a(B,!1)}}async function ke(){try{a(E,!0),a(p,"");const t={name:e(L),url:e(_),api_key:e(x),is_active:e(N)};e(g)?await F.collection("elastic_instances").update(e(g),t):await F.collection("elastic_instances").create(t),ve(),await G()}catch(t){a(p,t.message)}finally{a(E,!1)}}async function Ce(t){if(confirm("Are you sure you want to delete this instance?"))try{await F.collection("elastic_instances").delete(t),await G()}catch(o){alert(`Error: ${o.message}`)}}async function Ie(t){try{const c=await(await fetch(`${F.baseUrl}/api/connection/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"elastic",config:{url:t.url,api_key:t.api_key}})})).json();await F.collection("elastic_instances").update(t.id,{connection_status:c.success?"success":"failed",last_connection_test:new Date().toISOString(),spaces:c.spaces||[]}),await G()}catch(o){console.error("Connection test failed:",o)}}Te();var ee=st();Ye("21ec2",t=>{Ke(()=>{Ne.title="Elastic Instances - Settings"})});var pe=s(ee);{var Ee=t=>{var o=Ve(),c=s(o);ze(c,{class:"w-5 h-5"}),I(),r(o),j("click",o,xe),d(t,o)};f(pe,t=>{e(T)||t(Ee)})}var ue=n(pe,2);{var Pe=t=>{var o=Xe(),c=s(o),te=s(c,!0);r(c);var H=n(c,2);{var h=i=>{var v=We(),X=s(v),Y=s(X,!0);r(X),r(v),q(()=>C(Y,e(p))),d(i,v)};f(H,i=>{e(p)&&i(h)})}var w=n(H,2),R=s(w),l=n(s(R),2);Z(l),r(R);var P=n(R,2),O=n(s(P),2);Z(O),I(2),r(P);var A=n(P,2),S=s(A),D=s(S);r(S);var J=n(S,2);Z(J),I(2),r(A);var M=n(A,2),Q=s(M);Z(Q),I(2),r(M);var V=n(M,2),b=s(V),ae=s(b);{var re=i=>{ge(i,{class:"w-4 h-4 animate-spin"})},se=i=>{be(i,{class:"w-4 h-4"})};f(ae,i=>{e(B)?i(re):i(se,!1)})}I(),r(b);var k=n(b,2),$=s(k);{var ie=i=>{ge(i,{class:"w-4 h-4 animate-spin"})},W=i=>{var v=Re();q(()=>C(v,e(g)?"Update":"Save")),d(i,v)};f($,i=>{e(E)?i(ie):i(W,!1)})}r(k);var U=n(k,2);r(V),r(w),r(o),q(()=>{C(te,e(g)?"Edit Elastic Instance":"Add Elastic Instance"),C(D,`API Key ${e(g)?"(leave empty to keep current)":"*"}`),De(J,"placeholder",e(g)?"••••••••":"Your Elastic API key"),b.disabled=!e(_)||!e(x)||e(B),k.disabled=e(E)||!e(L)||!e(_)||!e(g)&&!e(x)}),ce(l,()=>e(L),i=>a(L,i)),ce(O,()=>e(_),i=>a(_,i)),ce(J,()=>e(x),i=>a(x,i)),qe(Q,()=>e(N),i=>a(N,i)),j("click",b,we),j("click",k,ke),j("click",U,ve),d(t,o)};f(ue,t=>{e(T)&&t(Pe)})}var Ae=n(ue,2);{var Se=t=>{var o=Ze();d(t,o)},je=t=>{var o=me(),c=fe(o);{var te=h=>{var w=et();d(h,w)},H=h=>{var w=rt();Je(w,5,()=>e(z),$e,(R,l)=>{var P=at(),O=s(P),A=s(O),S=s(A),D=s(S),J=s(D,!0);r(D);var M=n(D,2);{var Q=u=>{He(u,{class:"w-5 h-5 text-green-600"})},V=u=>{var K=me(),oe=fe(K);{var ne=le=>{Qe(le,{class:"w-5 h-5 text-red-600"})};f(oe,le=>{e(l).connection_status==="failed"&&le(ne)},!0)}d(u,K)};f(M,u=>{e(l).connection_status==="success"?u(Q):u(V,!1)})}r(S);var b=n(S,2),ae=s(b,!0);r(b);var re=n(b,2);{var se=u=>{var K=tt(),oe=s(K);r(K),q(ne=>C(oe,`Spaces: ${ne??""}`),[()=>e(l).spaces.join(", ")]),d(u,K)};f(re,u=>{e(l).spaces&&e(l).spaces.length>0&&u(se)})}r(A);var k=n(A,2),$=s(k),ie=s($,!0);r($),r(k),r(O);var W=n(O,2),U=s(W),i=s(U);be(i,{class:"w-4 h-4"}),I(),r(U);var v=n(U,2),X=s(v);Be(X,{class:"w-4 h-4"}),I(),r(v);var Y=n(v,2),Fe=s(Y);Ge(Fe,{class:"w-4 h-4"}),I(),r(Y),r(W),r(P),q(()=>{C(J,e(l).name),C(ae,e(l).url),Me($,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
								${e(l).is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`),C(ie,e(l).is_active?"Active":"Inactive")}),j("click",U,()=>Ie(e(l))),j("click",v,()=>he(e(l))),j("click",Y,()=>Ce(e(l).id)),d(R,P)}),r(w),d(h,w)};f(c,h=>{e(z).length===0&&!e(T)?h(te):h(H,!1)},!0)}d(t,o)};f(Ae,t=>{e(E)&&e(z).length===0?t(Se):t(je,!1)})}r(ee),d(ye,ee),Ue()}export{xt as component};

import"../chunks/CWj6FrbW.js";import{i as st}from"../chunks/Dl2LfGm4.js";import{o as it,s as f}from"../chunks/O7RWNxBF.js";import{c as V,f as G,a as l,p as dt,b as nt,e as ot,h as t,d as c,s as u,$ as lt,g as d,n as h,r as e,i as r,m as O,t as E,j as Ee,k as je}from"../chunks/C9NYA0Nw.js";import{i as y}from"../chunks/D2ldot_M.js";import{I as vt,s as ct,e as gt,d as xt,b as Pe,a as $e,i as pt}from"../chunks/rMS1oNTx.js";import{h as mt}from"../chunks/k5AYXn5z.js";import{p as S,a as _t}from"../chunks/BUCyip3L.js";import{P as Te}from"../chunks/DRykE2x8.js";import{D as ft}from"../chunks/CEdrxlJt.js";import{S as ut}from"../chunks/Ckivt0rV.js";import{T as yt}from"../chunks/Bv-fdLbk.js";import{T as Ie}from"../chunks/ChWmmJ1c.js";import{G as Ne}from"../chunks/Ll8lceZU.js";import{U as Se}from"../chunks/zdIQ9pKd.js";import{R as Ge}from"../chunks/Cx4sQyjC.js";import{l as bt,s as ht}from"../chunks/Cs0PMOxO.js";function wt(X,A){const L=bt(A,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]];vt(X,ht({name:"loader-circle"},()=>L,{get iconNode(){return M},children:(U,F)=>{var m=V(),D=G(m);ct(D,A,"default",{}),l(U,m)},$$slots:{default:!0}}))}var kt=c('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div></div>'),Et=c('<div class="bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),jt=c('<div class="card p-12 text-center animate-fade-in"><div class="mb-4"><!></div> <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-2">No projects yet</h3> <p class="text-gray-500 dark:text-gray-400 mb-6">Create your first project to start syncing Elastic Security rules with Git.</p> <a href="/projects/new" class="btn inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:shadow-md transition-all"><!> Create Project</a></div>'),Pt=c('<p class="text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"> </p>'),$t=c('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400">Export Only</span>'),Tt=c('<div class="flex items-start gap-2"><div class="p-1.5 bg-yellow-100 rounded"><!></div> <div class="min-w-0"><div class="text-xs font-medium text-gray-700 dark:text-gray-300">Test</div> <div class="text-xs text-gray-500 dark:text-gray-400 truncate"> </div> <div class="text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1"><!> </div></div></div>'),It=c('<div class="flex items-center gap-2 text-gray-400 dark:text-gray-500"><!> <span class="text-xs">No test env</span></div>'),Nt=c('<div class="flex items-center gap-2 text-gray-400 dark:text-gray-500"><!> <span class="text-xs text-emerald-600 dark:text-emerald-400">Elastic â†’ Git</span></div>'),St=c('<div class="flex items-start gap-2"><div class="p-1.5 bg-green-100 rounded"><!></div> <div class="min-w-0"><div class="text-xs font-medium text-gray-700 dark:text-gray-300">Production</div> <div class="text-xs text-gray-500 dark:text-gray-400 truncate"> </div> <div class="text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1"><!> </div></div></div>'),Gt=c('<div class="flex items-center gap-2 text-gray-400 dark:text-gray-500"><!> <span class="text-xs">No prod env</span></div>'),Lt=c("<div> </div>"),Mt=c("<!> Exporting...",1),Ut=c("<!> Quick Export",1),Ft=c('<button class="btn flex items-center justify-center gap-2 px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 hover:shadow-md transition-all text-sm disabled:opacity-50 disabled:cursor-not-allowed"><!></button>'),qt=c('<div class="card overflow-hidden animate-fade-in"><div class="p-6 border-b border-gray-100 dark:border-gray-800"><div class="flex items-start justify-between"><div class="flex-1"><a class="text-lg font-semibold text-gray-900 dark:text-gray-100 hover:text-blue-600"> </a> <!></div> <div class="flex items-center gap-1.5"><!> <span> </span></div></div></div> <div class="px-6 py-4 bg-gray-50 dark:bg-gray-800"><div class="grid grid-cols-2 gap-4"><!> <!></div></div> <div class="px-6 py-3 text-xs text-gray-500 dark:text-gray-400 border-t border-gray-100 dark:border-gray-800"><div class="flex items-center justify-between"><span><strong>Elastic:</strong> </span> <span><strong>Git:</strong> </span></div></div> <!> <div class="flex items-center gap-2 p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900"><!> <a class="btn flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:shadow-md transition-all text-sm"><!> Manage</a> <button class="btn flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg transition-all text-sm"><!></button></div></div>'),Ct=c('<div class="grid grid-cols-1 lg:grid-cols-2 gap-6"></div>'),Ot=c('<div class="space-y-6"><div class="flex items-center justify-between animate-fade-in"><div><h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">Projects</h1> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Manage your Elastic Security rule sync projects</p></div> <a href="/projects/new" class="btn inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:shadow-md transition-all"><!> New Project</a></div> <!></div>');function ra(X,A){dt(A,!1);let L=O([]),M=O(!0),U=O(""),F=O(null),m=O(null);it(async()=>{await D()});async function D(){try{u(M,!0);const i=await S.collection("projects").getFullList({expand:"elastic_instance,git_repository",sort:"-created"}),n=[];for(const p of i)try{const w=await S.collection("environments").getFullList({filter:`project = "${p.id}"`});n.push({...p,environments:w})}catch{n.push({...p,environments:[]})}u(L,n)}catch(i){u(U,i.message)}finally{u(M,!1)}}function R(i){var n;return(n=i.environments)==null?void 0:n.find(p=>p.name==="test")}function oe(i){var n;return(n=i.environments)==null?void 0:n.find(p=>p.name==="production")}async function Le(i){if(confirm("Are you sure you want to delete this project and all its environments?"))try{const n=await S.collection("environments").getFullList({filter:`project = "${i}"`});for(const p of n)await S.collection("environments").delete(p.id);await S.collection("projects").delete(i),await D()}catch(n){alert(`Error: ${n.message}`)}}async function Me(i){const n=R(i);if(n)try{u(F,i.id),u(m,null);const w=await(await _t(`${S.baseUrl}/api/sync/trigger`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:i.id,environment_id:n.id,direction:"elastic_to_git",branch:n.git_branch,space:n.elastic_space})})).json();w.success?u(m,{projectId:i.id,message:w.message||"Export complete",type:"success"}):u(m,{projectId:i.id,message:w.message||"Export failed",type:"error"})}catch(p){u(m,{projectId:i.id,message:p.message||"Export failed",type:"error"})}finally{u(F,null),setTimeout(()=>{u(m,null)},4e3)}}st();var Y=Ot();mt("rqn88j",i=>{ot(()=>{lt.title="Projects - Elastic Git Sync"})});var Z=t(Y),le=d(t(Z),2),Ue=t(le);Te(Ue,{class:"w-5 h-5"}),h(),e(le),e(Z);var Fe=d(Z,2);{var qe=i=>{var n=kt();l(i,n)},Ce=i=>{var n=V(),p=G(n);{var w=j=>{var P=Et(),z=t(P),ee=t(z,!0);e(z),e(P),E(()=>f(ee,r(U))),l(j,P)},Oe=j=>{var P=V(),z=G(P);{var ee=$=>{var k=jt(),q=t(k),o=t(q);ft(o,{class:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto"}),e(q);var J=d(q,6),T=t(J);Te(T,{class:"w-5 h-5"}),h(),e(J),e(k),l($,k)},Ae=$=>{var k=Ct();gt(k,5,()=>r(L),pt,(q,o,J)=>{var T=qt();xt(T,`animation-delay: ${J*50}ms; opacity: 0;`);var te=t(T),ve=t(te),ae=t(ve),Q=t(ae),De=t(Q,!0);e(Q);var Re=d(Q,2);{var ze=s=>{var a=Pt(),v=t(a,!0);e(a),E(()=>f(v,r(o).description)),l(s,a)};y(Re,s=>{r(o).description&&s(ze)})}e(ae);var ce=d(ae,2),ge=t(ce);{var Je=s=>{var a=$t();l(s,a)};y(ge,s=>{r(o).sync_mode==="export_only"&&s(Je)})}var re=d(ge,2),Qe=t(re,!0);e(re),e(ce),e(ve),e(te);var se=d(te,2),xe=t(se),pe=t(xe);{var We=s=>{const a=je(()=>R(r(o)));var v=Tt(),b=t(v),C=t(b);Ie(C,{class:"w-4 h-4 text-yellow-600"}),e(b);var g=d(b,2),x=d(t(g),2),_=t(x,!0);e(x);var I=d(x,2),B=t(I);Ne(B,{class:"w-3 h-3"});var H=d(B);e(I),e(g),e(v),E(()=>{var N,K;f(_,(N=r(a))==null?void 0:N.elastic_space),f(H,` ${((K=r(a))==null?void 0:K.git_branch)??""}`)}),l(s,v)},Be=s=>{var a=It(),v=t(a);Ie(v,{class:"w-4 h-4"}),h(2),e(a),l(s,a)};y(pe,s=>{R(r(o))?s(We):s(Be,!1)})}var He=d(pe,2);{var Ke=s=>{var a=Nt(),v=t(a);Se(v,{class:"w-4 h-4 text-emerald-500"}),h(2),e(a),l(s,a)},Ve=s=>{var a=V(),v=G(a);{var b=g=>{const x=je(()=>oe(r(o)));var _=St(),I=t(_),B=t(I);Ge(B,{class:"w-4 h-4 text-green-600"}),e(I);var H=d(I,2),N=d(t(H),2),K=t(N,!0);e(N);var be=d(N,2),he=t(be);Ne(he,{class:"w-3 h-3"});var rt=d(he);e(be),e(H),e(_),E(()=>{var we,ke;f(K,(we=r(x))==null?void 0:we.elastic_space),f(rt,` ${((ke=r(x))==null?void 0:ke.git_branch)??""}`)}),l(g,_)},C=g=>{var x=Gt(),_=t(x);Ge(_,{class:"w-4 h-4"}),h(2),e(x),l(g,x)};y(v,g=>{oe(r(o))?g(b):g(C,!1)},!0)}l(s,a)};y(He,s=>{r(o).sync_mode==="export_only"?s(Ke):s(Ve,!1)})}e(xe),e(se);var ie=d(se,2),me=t(ie),de=t(me),Xe=d(t(de));e(de);var _e=d(de,2),Ye=d(t(_e));e(_e),e(me),e(ie);var fe=d(ie,2);{var Ze=s=>{var a=Lt(),v=t(a,!0);e(a),E(()=>{$e(a,1,`px-4 py-2 text-xs font-medium ${r(m).type==="success"?"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-red-50 text-red-700 dark:bg-red-900/20 dark:text-red-400"}`),f(v,r(m).message)}),l(s,a)};y(fe,s=>{var a;((a=r(m))==null?void 0:a.projectId)===r(o).id&&s(Ze)})}var ue=d(fe,2),ye=t(ue);{var et=s=>{var a=Ft(),v=t(a);{var b=g=>{var x=Mt(),_=G(x);wt(_,{class:"w-4 h-4 animate-spin"}),h(),l(g,x)},C=g=>{var x=Ut(),_=G(x);Se(_,{class:"w-4 h-4"}),h(),l(g,x)};y(v,g=>{r(F)===r(o).id?g(b):g(C,!1)})}e(a),E(()=>a.disabled=r(F)===r(o).id),Ee("click",a,()=>Me(r(o))),l(s,a)};y(ye,s=>{R(r(o))&&s(et)})}var W=d(ye,2),tt=t(W);ut(tt,{class:"w-4 h-4"}),h(),e(W);var ne=d(W,2),at=t(ne);yt(at,{class:"w-4 h-4"}),e(ne),e(ue),e(T),E(()=>{var s,a,v,b;Pe(Q,"href",`/projects/${r(o).id??""}`),f(De,r(o).name),$e(re,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
									${r(o).is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}`),f(Qe,r(o).is_active?"Active":"Inactive"),f(Xe,` ${(((a=(s=r(o).expand)==null?void 0:s.elastic_instance)==null?void 0:a.name)||"Unknown")??""}`),f(Ye,` ${(((b=(v=r(o).expand)==null?void 0:v.git_repository)==null?void 0:b.name)||"Unknown")??""}`),Pe(W,"href",`/projects/${r(o).id??""}`)}),Ee("click",ne,()=>Le(r(o).id)),l(q,T)}),e(k),l($,k)};y(z,$=>{r(L).length===0?$(ee):$(Ae,!1)},!0)}l(j,P)};y(p,j=>{r(U)?j(w):j(Oe,!1)},!0)}l(i,n)};y(Fe,i=>{r(M)?i(qe):i(Ce,!1)})}e(Y),l(X,Y),nt()}export{ra as component};

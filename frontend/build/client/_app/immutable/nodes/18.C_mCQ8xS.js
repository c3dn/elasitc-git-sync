import"../chunks/CWj6FrbW.js";import{i as ze}from"../chunks/Dl2LfGm4.js";import{o as Me,s as _}from"../chunks/O7RWNxBF.js";import{c as be,f as ue,a as c,p as Re,j as S,b as Je,e as qe,h as r,d as y,g as i,s as n,$ as Ge,n as ge,r as t,i as e,m as F,t as G,Y as L,k as He,o as fe}from"../chunks/C9NYA0Nw.js";import{i as h}from"../chunks/D2ldot_M.js";import{I as Ie,s as Ye,r as H,e as xe,f as Be,i as Ke,c as Qe,a as Ve}from"../chunks/z_jCEgha.js";import{h as Xe}from"../chunks/k5AYXn5z.js";import{b as pe,a as Ze}from"../chunks/DkcqxK1V.js";import{a as I,p as Y}from"../chunks/BUCyip3L.js";import{P as ea}from"../chunks/B790a_s2.js";import{W as _e}from"../chunks/Dkli4Abh.js";import{l as aa,s as ta}from"../chunks/Cs0PMOxO.js";import{P as ra}from"../chunks/DPDXo5vH.js";import{T as sa}from"../chunks/Dr9VXG2L.js";import{C as ia}from"../chunks/B_iYIkWe.js";import{C as oa}from"../chunks/D3EV4tGk.js";import{C as da}from"../chunks/DpP0kgc1.js";import{f as la}from"../chunks/CWlArps7.js";function na(se,B){const O=aa(B,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];Ie(se,ta({name:"send"},()=>O,{get iconNode(){return z},children:(k,w)=>{var p=be(),s=ue(p);Ye(s,B,"default",{}),c(k,p)},$$slots:{default:!0}}))}var ca=y('<div class="bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-800"> </p></div>'),va=y('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div></div>'),ga=y('<div class="card p-12 text-center"><!> <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">No webhooks configured</h3> <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Add a webhook to receive notifications about rule changes.</p></div>'),pa=y('<span class="text-xs px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded">Disabled</span>'),ba=y('<div class="card p-4"><div class="flex items-center justify-between"><div class="flex items-center gap-3 flex-1 min-w-0"><div><!></div> <div class="min-w-0 flex-1"><div class="flex items-center gap-2"><p class="text-sm font-medium text-gray-900 dark:text-gray-100"> </p> <!></div> <p class="text-xs text-gray-500 dark:text-gray-400 truncate"> </p> <div class="flex items-center gap-2 mt-1"><!> <span class="text-xs text-gray-400 dark:text-gray-500"><!></span></div></div></div> <div class="flex items-center gap-1"><button class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors" title="Send test webhook"><!></button> <button class="p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors" title="Edit"><!></button> <button class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors" title="Delete"><!></button></div></div></div>'),ua=y('<div class="space-y-3"></div>'),ma=y('<label class="flex items-start gap-3 p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer"><input type="checkbox" class="mt-0.5 rounded border-gray-300 dark:border-gray-600 text-primary-600 focus:ring-primary-500"/> <div><p class="text-sm font-medium text-gray-900 dark:text-gray-100"> </p> <p class="text-xs text-gray-500 dark:text-gray-400"> </p></div></label>'),ya=y('<div class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"><div class="bg-white dark:bg-gray-900 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100"> </h3></div> <div class="px-6 py-4 space-y-4"><div><label for="wh-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name</label> <input id="wh-name" type="text" placeholder="e.g., Slack Notifications" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"/></div> <div><label for="wh-url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">URL</label> <input id="wh-url" type="url" placeholder="https://hooks.slack.com/services/..." class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"/></div> <div><label for="wh-secret" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Secret (optional)</label> <input id="wh-secret" type="password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"/></div> <div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Events</label> <div class="space-y-2"></div></div> <div class="flex items-center gap-2"><input type="checkbox" id="wh-active" class="rounded border-gray-300 dark:border-gray-600 text-primary-600 focus:ring-primary-500"/> <label for="wh-active" class="text-sm text-gray-700 dark:text-gray-300">Enabled</label></div></div> <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-end gap-3"><button class="px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors">Cancel</button> <button class="px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors"> </button></div></div></div>'),fa=y('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Webhooks</h2> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Configure webhook endpoints for notifications</p></div> <button class="flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors"><!> Add Webhook</button></div> <!> <!> <!></div>');function La(se,B){Re(B,!1);let O=F([]),z=F(!0),k=F(""),w=F(!1),p=F(""),s=F({name:"",url:"",secret:"",events:[],is_active:!0});const he=[{id:"change_detected",label:"Change Detected",description:"When new rule changes are found in Elastic"},{id:"change_approved",label:"Change Approved",description:"When a reviewer approves a change"},{id:"change_rejected",label:"Change Rejected",description:"When a reviewer rejects a change"},{id:"revert_failed",label:"Revert Failed",description:"When reverting a rejected change fails in Elastic"},{id:"sync_error",label:"Sync Error",description:"When a sync operation encounters an error"}];Me(async()=>{await K()});async function K(){try{n(z,!0);const a=await I(`${Y.baseUrl}/api/webhooks`);if(!a.ok)throw new Error("Failed to load webhooks");const o=await a.json();n(O,o.webhooks||[])}catch(a){n(k,a.message)}finally{n(z,!1)}}function ke(){n(s,{name:"",url:"",secret:"",events:["change_detected"],is_active:!0}),n(p,""),n(w,!0)}function we(a){n(s,{name:a.name,url:a.url,secret:"",events:Array.isArray(a.events)?a.events:[],is_active:a.is_active}),n(p,a.id),n(w,!0)}async function We(){try{const a={...e(s)};e(p)?(a.secret||delete a.secret,await I(`${Y.baseUrl}/api/webhooks/${e(p)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})):await I(`${Y.baseUrl}/api/webhooks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),n(w,!1),await K()}catch(a){n(k,a.message)}}async function Ce(a){if(confirm("Delete this webhook?"))try{await I(`${Y.baseUrl}/api/webhooks/${a}`,{method:"DELETE"}),await K()}catch(o){n(k,o.message)}}async function Ee(a){try{const b=await(await I(`${Y.baseUrl}/api/webhooks/${a}/test`,{method:"POST"})).json();b.success?alert("Test webhook sent successfully!"):alert("Test failed: "+(b.message||"Unknown error")),await K()}catch(o){alert("Error: "+o.message)}}function je(a){e(s).events.includes(a)?L(s,e(s).events=e(s).events.filter(o=>o!==a)):L(s,e(s).events=[...e(s).events,a])}ze();var ie=fa();Xe("pvuutr",a=>{qe(()=>{Ge.title="Webhooks - Settings - Elastic Git Sync"})});var oe=r(ie),de=i(r(oe),2),Se=r(de);ea(Se,{class:"w-4 h-4"}),ge(),t(de),t(oe);var me=i(oe,2);{var $e=a=>{var o=ca(),b=r(o),W=r(b,!0);t(b),t(o),G(()=>_(W,e(k))),c(a,o)};h(me,a=>{e(k)&&a($e)})}var ye=i(me,2);{var Te=a=>{var o=va();c(a,o)},Ne=a=>{var o=be(),b=ue(o);{var W=f=>{var v=ga(),u=r(v);_e(u,{class:"w-12 h-12 text-gray-300 dark:text-gray-500 mx-auto mb-4"}),ge(4),t(v),c(f,v)},Q=f=>{var v=ua();xe(v,5,()=>e(O),u=>u.id,(u,l)=>{var C=ba(),M=r(C),E=r(M),x=r(E),R=r(x);{let d=He(()=>e(l).is_active?"text-green-600":"text-gray-400 dark:text-gray-500");_e(R,{get class(){return`w-5 h-5 ${e(d)??""}`}})}t(x);var J=i(x,2),$=r(J),T=r($),V=r(T,!0);t(T);var X=i(T,2);{var N=d=>{var m=pa();c(d,m)};h(X,d=>{e(l).is_active||d(N)})}t($);var q=i($,2),g=r(q,!0);t(q);var j=i(q,2),P=r(j);{var U=d=>{ia(d,{class:"w-3 h-3 text-green-500"})},Z=d=>{var m=be(),ve=ue(m);{var Le=D=>{oa(D,{class:"w-3 h-3 text-red-500"})},Oe=D=>{da(D,{class:"w-3 h-3 text-gray-400 dark:text-gray-500"})};h(ve,D=>{e(l).last_status==="failed"?D(Le):D(Oe,!1)},!0)}c(d,m)};h(P,d=>{e(l).last_status==="success"?d(U):d(Z,!1)})}var A=i(P,2),le=r(A);{var ee=d=>{var m=fe();G(ve=>_(m,`Last triggered ${ve??""}`),[()=>la(new Date(e(l).last_triggered),{addSuffix:!0})]),c(d,m)},ne=d=>{var m=fe("Never triggered");c(d,m)};h(le,d=>{e(l).last_triggered?d(ee):d(ne,!1)})}t(A),t(j),t(J),t(E);var ae=i(E,2),te=r(ae),Ae=r(te);na(Ae,{class:"w-4 h-4"}),t(te);var re=i(te,2),De=r(re);ra(De,{class:"w-4 h-4"}),t(re);var ce=i(re,2),Fe=r(ce);sa(Fe,{class:"w-4 h-4"}),t(ce),t(ae),t(M),t(C),G(()=>{Ve(x,1,`p-2 rounded-lg ${e(l).is_active?"bg-green-100":"bg-gray-100 dark:bg-gray-800"}`),_(V,e(l).name),_(g,e(l).url)}),S("click",te,()=>Ee(e(l).id)),S("click",re,()=>we(e(l))),S("click",ce,()=>Ce(e(l).id)),c(u,C)}),t(v),c(f,v)};h(b,f=>{e(O).length===0&&!e(w)?f(W):f(Q,!1)},!0)}c(a,o)};h(ye,a=>{e(z)?a(Te):a(Ne,!1)})}var Pe=i(ye,2);{var Ue=a=>{var o=ya(),b=r(o),W=r(b),Q=r(W),f=r(Q,!0);t(Q),t(W);var v=i(W,2),u=r(v),l=i(r(u),2);H(l),t(u);var C=i(u,2),M=i(r(C),2);H(M),t(C);var E=i(C,2),x=i(r(E),2);H(x),t(E);var R=i(E,2),J=i(r(R),2);xe(J,5,()=>he,Ke,(g,j)=>{var P=ma(),U=r(P);H(U);var Z=i(U,2),A=r(Z),le=r(A,!0);t(A);var ee=i(A,2),ne=r(ee,!0);t(ee),t(Z),t(P),G(ae=>{Be(U,ae),_(le,e(j).label),_(ne,e(j).description)},[()=>e(s).events.includes(e(j).id)]),S("change",U,()=>je(e(j).id)),c(g,P)}),t(J),t(R);var $=i(R,2),T=r($);H(T),ge(2),t($),t(v);var V=i(v,2),X=r(V),N=i(X,2),q=r(N,!0);t(N),t(V),t(b),t(o),G(()=>{_(f,e(p)?"Edit Webhook":"Add Webhook"),Qe(x,"placeholder",e(p)?"Leave blank to keep current":"HMAC signing secret"),N.disabled=!e(s).name||!e(s).url||e(s).events.length===0,_(q,e(p)?"Save Changes":"Create Webhook")}),pe(l,()=>e(s).name,g=>L(s,e(s).name=g)),pe(M,()=>e(s).url,g=>L(s,e(s).url=g)),pe(x,()=>e(s).secret,g=>L(s,e(s).secret=g)),Ze(T,()=>e(s).is_active,g=>L(s,e(s).is_active=g)),S("click",X,()=>n(w,!1)),S("click",N,We),c(a,o)};h(Pe,a=>{e(w)&&a(Ue)})}t(ie),S("click",de,ke),c(se,ie),Je()}export{La as component};
